<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2022-12-28">

<title>ISSS608 - Take-home Exercise 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-PKMQ2W4ZRC"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-PKMQ2W4ZRC', { 'anonymize_ip': true});
</script>
<script src="../site_libs/htmlwidgets-1.6.0/htmlwidgets.js"></script>
<script src="../site_libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<link rel="stylesheet" href="../styles.css">
<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ISSS608</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../Hands-on_Ex1.1.qmd">
 <span class="dropdown-text">Take-home Exercise [1]</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../in-class_ex/in-class_ex1/In-class_Ex1.qmd">
 <span class="dropdown-text">Spatial Weights &amp; Applications [3]</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-projects" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Projects</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-projects">    
        <li>
    <a class="dropdown-item" href="../class_project/project_1/spatial_weights.qmd">
 <span class="dropdown-text">Class Project 1 - Spatial Weights &amp; Applications</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-references--notes" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">References &amp; Notes</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-references--notes">    
        <li>
    <a class="dropdown-item" href="../pnote/test1.html">
 <span class="dropdown-text">Test &amp; Exploration 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../pnote/test2.html">
 <span class="dropdown-text">Test &amp; Exploration 2</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">OVERVIEW</a>
  <ul class="collapse">
  <li><a href="#proposed-sketch" id="toc-proposed-sketch" class="nav-link" data-scroll-target="#proposed-sketch">. Proposed Sketch</a></li>
  </ul></li>
  <li><a href="#r-package-required" id="toc-r-package-required" class="nav-link" data-scroll-target="#r-package-required">2. R PACKAGE REQUIRED</a>
  <ul class="collapse">
  <li><a href="#load-r-packages" id="toc-load-r-packages" class="nav-link" data-scroll-target="#load-r-packages">2.1 Load R Packages</a></li>
  </ul></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">3. DATA</a>
  <ul class="collapse">
  <li><a href="#acquire-data-source" id="toc-acquire-data-source" class="nav-link" data-scroll-target="#acquire-data-source">3.1 Acquire Data Source</a></li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data">3.2 Import Data</a>
  <ul class="collapse">
  <li><a href="#import-tableau-data" id="toc-import-tableau-data" class="nav-link" data-scroll-target="#import-tableau-data">3.2.1 Import Tableau Data</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#pareto-chart" id="toc-pareto-chart" class="nav-link" data-scroll-target="#pareto-chart">3.1. Pareto Chart</a>
  <ul class="collapse">
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling"><strong>3.1.2 Data Wrangling</strong></a></li>
  <li><a href="#plot-pareto-chart" id="toc-plot-pareto-chart" class="nav-link" data-scroll-target="#plot-pareto-chart"><strong>3.1.3 Plot Pareto Chart</strong></a></li>
  <li><a href="#population-pyramid" id="toc-population-pyramid" class="nav-link" data-scroll-target="#population-pyramid"><strong>3.2. Population Pyramid</strong></a>
  <ul class="collapse">
  <li><a href="#import-dataset" id="toc-import-dataset" class="nav-link" data-scroll-target="#import-dataset"><strong>3.2.1 Import Dataset</strong></a></li>
  <li><a href="#data-wrangling-1" id="toc-data-wrangling-1" class="nav-link" data-scroll-target="#data-wrangling-1">** 3.2.2 Data Wrangling**</a></li>
  <li><a href="#plot-age-sex-population-pyramid" id="toc-plot-age-sex-population-pyramid" class="nav-link" data-scroll-target="#plot-age-sex-population-pyramid"><strong>3.2.3 Plot Age-Sex Population Pyramid</strong></a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home Exercise 1</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 28, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>OVERVIEW</h1>
<p>In this take-home exercise, we will explore the pros and cons of creating data visualisations using <strong>ggplot2</strong> and Tableau. The two data visualisations included in this exercise are:</p>
<ul>
<li><p>A pareto chart showing the distribution of returns by a fictious superstore</p></li>
<li><p>A population pyramid of Singapore by age cohort and gender</p></li>
</ul>
<section id="challenges-faced" class="level4">
<h4 class="anchored" data-anchor-id="challenges-faced"><strong>CHALLENGES FACED</strong></h4>
<ul>
<li><p>The raw data had to be extensively transformed before it could be used for visualisation. It is challenging to ensure that the fields have been adequately transformed, and frequently results in recycle work where one has to modify data wrangling after doing the visualisation and repeating again. For example, the Age Group column for the population pyramid has a character data type, which means that when plotting or generating dataframes including this column, 0_to_4 would be parsed first, followed by 10_to_14, instead of the expected 5_to_9. The order in the visualisation would be incorrect based on this order. The issue was resolved by manually changing the order using <em>mutate()</em> and then sorting via <em>arrange()</em>.</p></li>
<li><p>The secondary axes in <strong>ggplot2</strong> is just based on a one-to-one transformation of the primary axes, hence the charts are still referenced to the primary axes. The challenge was resolved by transforming the secondary axis by a coefficient, such that the scale matches the primary axis.</p></li>
<li><p>As <strong>ggplot2</strong> produces static charts, bringing in interactivity in the visualizations may be a challenge. This was resolved by using <em>plotly</em> package, which can be quickly transformed for the Age-Sex Population Pyramid. The pareto chart, which contained a secondary axis, required to be plotted using <strong>plotly</strong> tools.</p></li>
<li><p>The default visualization created with <strong>ggplot2</strong> is not appealing and not professional looking. The default grey background was difficult to view for some charts and some of the default themes are not easy on the eyes. Hence, some charts may need to be extensively customized. For instance, the grid lines, axis labels, colour scheme of the pareto chart had to be customised.</p></li>
</ul>
</section>
<section id="comparing-between-tableau-and-r" class="level4">
<h4 class="anchored" data-anchor-id="comparing-between-tableau-and-r"><strong>COMPARING BETWEEN TABLEAU AND R</strong></h4>
<ul>
<li><p>In R, data preparation for different charts using different data sets can be done on one platform using the same environment. Tableau, on the other hand requires separate workbook for separate data sets. . On the other hand, web scraping cannot be performed on Tableau. Both pareto chart and population pyramid can be plotted in the same environment in R, whereas requires 2 workbooks in Tableau.</p></li>
<li><p>Tableau is more user friendly and fool-proof in creating visualisations. However, R has a rich repository of packages that directly creates different chart types, whereas Tableau requires some manipulation of base chart types. For example, though not carried out in this exercise, a basic pareto plot can be created by <em>stat_pareto()</em> of <strong>ggQC</strong>, and a basic population pyramid can be plotted using <em>nPyramid()</em> of <strong>rCharts</strong>.</p></li>
<li><p>Visualisations in Tableau are interactive, whereas <strong>ggplot2</strong> in R is static. Extra effort is also required to customise the details of the visualisation in <strong>ggplot2</strong>. Interactivity and customisation can be included through <strong>ggplot</strong> and <strong>plotly</strong>. Once a chart is created, the same visualisation using different variables or level of details can be easily re-created using similar lines of code.</p></li>
</ul>
</section>
<section id="proposed-sketch" class="level2">
<h2 class="anchored" data-anchor-id="proposed-sketch">. Proposed Sketch</h2>
<p>Reference charts were already created using Tableau for in-class exercise 2, hence they will be used as the proposed sketch for the data visualisations for <strong>ggplot2</strong>.</p>
<section id="superstore-returns-pareto-chart-by-tableau" class="level4">
<h4 class="anchored" data-anchor-id="superstore-returns-pareto-chart-by-tableau"><strong>SUPERSTORE RETURNS PARETO CHART BY TABLEAU</strong></h4>
</section>
<section id="singapore-population-pyramid-2021-by-tableau" class="level4">
<h4 class="anchored" data-anchor-id="singapore-population-pyramid-2021-by-tableau"><strong>SINGAPORE POPULATION PYRAMID 2021 BY TABLEAU</strong></h4>
<p>As Tableau produces interactive charts and dashboards, we will use <strong>plotly</strong> to convert the <strong>ggplot2</strong> plots to produce interactive graphs for a more objective comparison.</p>
</section>
</section>
</section>
<section id="r-package-required" class="level1">
<h1>2. R PACKAGE REQUIRED</h1>
<p>The following are the packages required for this exercise :</p>
<section id="load-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="load-r-packages">2.1 Load R Packages</h2>
<div class="callout-warning callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><span style="color:#a39f9d">Usage of the code chunk below :</span></p>
<p><span style="color:#d46e15"><strong><em>p_load( )</em></strong> - pacman -</span> to load packages into R environment. This function will attempt to install the package from CRAN or pacman repository list if it is not installed.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, readxl, knitr, plotly, skimr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><span style="color:#d69c3c">Remarks :</span></p>
<p><span style="color:#d69c3c">sf, tidyverse, questionr, janitor, psych, ggplot2, gcookbook, tmap, ggpubr, egg, corrplot, gtsummary, regclass, caret, heatmaply, ggdendro, cluster, factoextra, spdep, ClustGeo, GGally, skimr, stringr, funModeling, knitr, caTools, viridis, rgeoda, cowplot, patchwork.</span></p>
<p><span style="color:#d69c3c">Alternate code chunk -</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'tidyverse'</span>, <span class="st">'readxl'</span>, <span class="st">'knitr'</span>, <span class="st">'plotly'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(p <span class="cf">in</span> packages){</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(p, <span class="at">character.only =</span> T)){</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(p)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(p, <span class="at">character.only =</span> T)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="data" class="level1">
<h1>3. DATA</h1>
<section id="acquire-data-source" class="level2">
<h2 class="anchored" data-anchor-id="acquire-data-source">3.1 Acquire Data Source</h2>
<ul>
<li><p>Tableau Fictatious Dataset</p>
<ol type="1">
<li>Download “Superstore” <a href="https://community.tableau.com/s/question/0D54T00000OPxEhSAL/does-any-have-the-sample-superstore-dataset-for-tableau-version-20203-when-i-downloaded-tableau-the-datasources-file-was-empty-i-tried-to-look-at-saved-data-sources-already">dataset</a> for <strong>Tableau</strong> version 2020.3.</li>
<li>Rename the title to “superstore_2020.3”.</li>
</ol></li>
<li><p>Singstat Dataset for Population</p>
<ol type="1">
<li>Download “Singapore Residents by Planning Area Subzone, Age Group, Sex and Type of Dwelling, June 2022” <a href="https://www.singstat.gov.sg/find-data/search-by-theme/population/geographic-distribution/latest-data">dataset</a> in csv format from Singstat.gov.sg.</li>
</ol></li>
</ul>
</section>
<section id="import-data" class="level2">
<h2 class="anchored" data-anchor-id="import-data">3.2 Import Data</h2>
<section id="import-tableau-data" class="level3">
<h3 class="anchored" data-anchor-id="import-tableau-data">3.2.1 Import Tableau Data</h3>
<div class="callout-warning callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Two (2) steps : import and inspect imported data set.</p>
<section id="import-data-1" class="level4">
<h4 class="anchored" data-anchor-id="import-data-1">3.2.1.1 import data</h4>
<div class="callout-alert callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><span style="color:#a39f9d">Usage of the code chunk below :</span></p>
<p><span style="color:#d46e15"><strong><em>read_xls( )</em></strong> - readxl -</span> to read excel into a tibble.</p>
<ul>
<li><span style="color:#d46e15"><strong>c<em>ol_select( )</em></strong> - readr -</span> to include only the selected variables into <em>wp_cood</em> data frame.</li>
</ul>
<p><span style="color:#d46e15"><strong><em>rename( )</em></strong> - dplyr -</span> to remove “#” from the variables.</p>
<p><span style="color:#d46e15"><strong><em>problems( )</em></strong> - readr -</span> to reveal any parsing errors when importing the CSV file.</p>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>orders <span class="ot">&lt;-</span> <span class="fu">read_xls</span>(<span class="st">"data/superstore_2020.3.xls"</span>,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sheet =</span> <span class="st">"Orders"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">problems</span>(orders)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>returns <span class="ot">&lt;-</span> <span class="fu">read_xls</span>(<span class="st">"data/superstore_2020.3.xls"</span>,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sheet =</span> <span class="st">"Returns"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">problems</span>(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="inspect-for-missing-value" class="level4">
<h4 class="anchored" data-anchor-id="inspect-for-missing-value">3.2.1.2 inspect for missing value</h4>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(orders)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">orders</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">9994</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">21</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">POSIXct</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 20%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Order ID</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5009</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ship Mode</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Customer ID</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">793</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Customer Name</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">793</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Segment</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Country/Region</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">City</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">531</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">State</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Region</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Product ID</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1862</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Category</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sub-Category</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Product Name</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">127</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1849</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 13%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Row ID</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4997.50</td>
<td style="text-align: right;">2885.16</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2499.25</td>
<td style="text-align: right;">4997.50</td>
<td style="text-align: right;">7495.75</td>
<td style="text-align: right;">9994.00</td>
<td style="text-align: left;">▇▇▇▇▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">Postal Code</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">55245.23</td>
<td style="text-align: right;">32038.72</td>
<td style="text-align: right;">1040.00</td>
<td style="text-align: right;">23223.00</td>
<td style="text-align: right;">57103.00</td>
<td style="text-align: right;">90008.00</td>
<td style="text-align: right;">99301.00</td>
<td style="text-align: left;">▆▃▃▅▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sales</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">229.86</td>
<td style="text-align: right;">623.25</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">17.28</td>
<td style="text-align: right;">54.49</td>
<td style="text-align: right;">209.94</td>
<td style="text-align: right;">22638.48</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Quantity</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.79</td>
<td style="text-align: right;">2.23</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">14.00</td>
<td style="text-align: left;">▇▅▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Discount</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: left;">▇▆▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Profit</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">28.66</td>
<td style="text-align: right;">234.26</td>
<td style="text-align: right;">-6599.98</td>
<td style="text-align: right;">1.73</td>
<td style="text-align: right;">8.67</td>
<td style="text-align: right;">29.36</td>
<td style="text-align: right;">8399.98</td>
<td style="text-align: left;">▁▁▇▁▁</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: POSIXct</strong></p>
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 17%">
<col style="width: 12%">
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: left;">min</th>
<th style="text-align: left;">max</th>
<th style="text-align: left;">median</th>
<th style="text-align: right;">n_unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Order Date</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2017-01-03</td>
<td style="text-align: left;">2020-12-30</td>
<td style="text-align: left;">2019-06-26</td>
<td style="text-align: right;">1236</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ship Date</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2017-01-07</td>
<td style="text-align: left;">2021-01-05</td>
<td style="text-align: left;">2019-06-29</td>
<td style="text-align: right;">1334</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(returns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">returns</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Returned</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Order ID</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">296</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="pareto-chart" class="level1">
<h1>3.1. Pareto Chart</h1>
<p>Pareto charts show the ordered frequency counts of data. They show the ordered frequency counts of values for the different levels of a categorical or nominal variable. These charts are often used to identify areas to focus on first in process improvement, as supported by the <a href="https://en.wikipedia.org/wiki/Pareto_principle">Pareto Principle (80/20 Rule)</a>.</p>
<section id="data-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="data-wrangling"><strong>3.1.2 Data Wrangling</strong></h3>
<section id="joining-the-two-data-frames" class="level4">
<h4 class="anchored" data-anchor-id="joining-the-two-data-frames"><strong>JOINING THE TWO DATA FRAMES</strong></h4>
<p>To combine the separate data frames, the <em>left_join()</em> of <strong>dplyr</strong> is used to join the returns data frame and orders data frame by using Order ID as the unique identifier.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>joined_tab <span class="ot">&lt;-</span> <span class="fu">left_join</span>(returns, orders,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'Order ID'</span> <span class="ot">=</span> <span class="st">'Order ID'</span>))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(joined_tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 22
  Returned `Order ID`    Row I…¹ `Order Date`        `Ship Date`         Ship …²
  &lt;chr&gt;    &lt;chr&gt;           &lt;dbl&gt; &lt;dttm&gt;              &lt;dttm&gt;              &lt;chr&gt;  
1 Yes      CA-2017-1007…    6315 2017-11-24 00:00:00 2017-11-29 00:00:00 Standa…
2 Yes      CA-2017-1007…    6316 2017-11-24 00:00:00 2017-11-29 00:00:00 Standa…
3 Yes      CA-2017-1007…    6317 2017-11-24 00:00:00 2017-11-29 00:00:00 Standa…
4 Yes      CA-2017-1007…    6318 2017-11-24 00:00:00 2017-11-29 00:00:00 Standa…
5 Yes      CA-2017-1007…    6315 2017-11-24 00:00:00 2017-11-29 00:00:00 Standa…
6 Yes      CA-2017-1007…    6316 2017-11-24 00:00:00 2017-11-29 00:00:00 Standa…
# … with 16 more variables: `Customer ID` &lt;chr&gt;, `Customer Name` &lt;chr&gt;,
#   Segment &lt;chr&gt;, `Country/Region` &lt;chr&gt;, City &lt;chr&gt;, State &lt;chr&gt;,
#   `Postal Code` &lt;dbl&gt;, Region &lt;chr&gt;, `Product ID` &lt;chr&gt;, Category &lt;chr&gt;,
#   `Sub-Category` &lt;chr&gt;, `Product Name` &lt;chr&gt;, Sales &lt;dbl&gt;, Quantity &lt;dbl&gt;,
#   Discount &lt;dbl&gt;, Profit &lt;dbl&gt;, and abbreviated variable names ¹​`Row ID`,
#   ²​`Ship Mode`</code></pre>
</div>
</div>
</section>
<section id="compute-the-frequency-count-by-sub-category" class="level4">
<h4 class="anchored" data-anchor-id="compute-the-frequency-count-by-sub-category"><strong>COMPUTE THE FREQUENCY COUNT BY SUB-CATEGORY</strong></h4>
<p>To achieve the frequency count of returns by sub-category, <em>group_by()</em> of <strong>dplyr</strong> package is used to group the orders by Sub-Category. Then, <em>summarise()</em> of <strong>dplyr</strong> is used to count (i.e.&nbsp;n()) the number of returned orders.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>freq_returned <span class="ot">&lt;-</span> joined_tab <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">Sub-Category</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">'Returns'</span><span class="ot">=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(freq_returned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  `Sub-Category` Returns
  &lt;chr&gt;            &lt;int&gt;
1 Accessories        251
2 Appliances         177
3 Art                177
4 Binders            552
5 Bookcases           51
6 Chairs             238</code></pre>
</div>
</div>
</section>
<section id="sorting-data" class="level4">
<h4 class="anchored" data-anchor-id="sorting-data"><strong>SORTING DATA</strong></h4>
<p>By default, the values of the tibble data frame is sorted according to the values of the first column. In this case, the values are sorted alphabetically by Sub-Category field.</p>
<p>We will need to sort the sub-category field by descending order of values in the Returns field. To accomplish this task, the <em>arrange()</em> of <strong>dplyr</strong> package is used as shown in the code chunk below.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>freq_sorted <span class="ot">&lt;-</span> freq_returned <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Returns))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(freq_sorted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  `Sub-Category` Returns
  &lt;chr&gt;            &lt;int&gt;
1 Binders            552
2 Paper              487
3 Phones             309
4 Furnishings        266
5 Accessories        251
6 Chairs             238</code></pre>
</div>
</div>
</section>
<section id="compute-the-cumulative-frequency" class="level4">
<h4 class="anchored" data-anchor-id="compute-the-cumulative-frequency"><strong>COMPUTE THE CUMULATIVE FREQUENCY</strong></h4>
<p>Lastly, we can compute the cumulative frequency of returns by product sub-category. This task will be performed by using <em>mutate()</em> of <strong>dplyr</strong> package and <em>cumsum()</em> of Base R.</p>
<p>The newly computed cumulative frequency values will be stored in a new field called cumfreq.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>freq_cum <span class="ot">&lt;-</span> freq_sorted <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cumfreq =</span> <span class="fu">cumsum</span>(Returns)) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cum =</span> <span class="fu">cumsum</span>(Returns)<span class="sc">/</span><span class="fu">sum</span>(Returns))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(freq_cum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  `Sub-Category` Returns cumfreq   cum
  &lt;chr&gt;            &lt;int&gt;   &lt;int&gt; &lt;dbl&gt;
1 Binders            552     552 0.171
2 Paper              487    1039 0.322
3 Phones             309    1348 0.418
4 Furnishings        266    1614 0.500
5 Accessories        251    1865 0.578
6 Chairs             238    2103 0.652</code></pre>
</div>
</div>
</section>
</section>
<section id="plot-pareto-chart" class="level3">
<h3 class="anchored" data-anchor-id="plot-pareto-chart"><strong>3.1.3 Plot Pareto Chart</strong></h3>
<section id="static-pareto-chart" class="level4">
<h4 class="anchored" data-anchor-id="static-pareto-chart"><strong>STATIC PARETO CHART</strong></h4>
<p>A pareto chart was plotted using <strong>ggplot2</strong> as follows:</p>
<ul>
<li><p><em>geom_col()</em> instead of <em>geom_bar()</em> was used to create the bar chart as we do not need to modify the data, and want the height of the bar to represent the actual counts of returns.</p></li>
<li><p><em>geom_line()</em> and <em>geom_point()</em> was used for the line and scatter plot for the cumulative frequency of return counts. The scatter plot helps reader to identify the corresponding cumulative frequency for each product in a static chart.</p></li>
<li><p><em>scale_y_continuous()</em> was used to adjust the interval between the grid lines and add a secondary y axes for the cumulative percentage of returns for each product. The secondary y axes is just based on a one-to-one transformation of the primary axes, hence both bar and line charts are still plotted with reference to the primary axes.</p></li>
<li><p><em>theme()</em> was lastly used to adjust the background color and grid lines of the plot to improve visibility to readers.</p></li>
</ul>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>pa <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> freq_cum, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(<span class="st">`</span><span class="at">Sub-Category</span><span class="st">`</span>,<span class="sc">-</span><span class="st">`</span><span class="at">Returns</span><span class="st">`</span>))) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="st">`</span><span class="at">Returns</span><span class="st">`</span>), <span class="at">fill =</span> <span class="st">'lightblue'</span>, <span class="at">width=</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="st">`</span><span class="at">cumfreq</span><span class="st">`</span>), <span class="at">color =</span> <span class="st">'grey20'</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span><span class="st">`</span><span class="at">cumfreq</span><span class="st">`</span>, <span class="at">group =</span> <span class="dv">1</span>), <span class="at">colour =</span> <span class="st">'grey20'</span>, <span class="at">size =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sub-Category"</span>, <span class="at">title =</span> <span class="st">"Pareto Chart of returns by sub-category"</span>) <span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">'Returns (absolute frequency)'</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">3500</span>, <span class="dv">300</span>), <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">3500</span>, <span class="dv">100</span>),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">*</span><span class="dv">1</span><span class="sc">/</span><span class="fu">sum</span>(freq_cum<span class="sc">$</span>Returns), <span class="at">name =</span> <span class="st">'Cumulative Frequency'</span>, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.1</span>), <span class="at">labels =</span> scales<span class="sc">::</span>percent)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fl">0.8</span><span class="sc">*</span><span class="fu">sum</span>(freq_cum<span class="sc">$</span>Returns), <span class="at">linetype=</span><span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="dv">17</span>, <span class="fl">0.8</span><span class="sc">*</span><span class="fu">sum</span>(freq_cum<span class="sc">$</span>Returns), <span class="at">label =</span> <span class="st">"80.0%"</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">'white'</span>, <span class="at">colour =</span> <span class="st">'grey60'</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">'solid'</span>),</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.3</span>, <span class="at">linetype =</span> <span class="st">'solid'</span>, <span class="at">colour =</span> <span class="st">'grey85'</span>),</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.2</span>, <span class="at">linetype =</span> <span class="st">'solid'</span>, <span class="at">colour =</span> <span class="st">'grey90'</span>),</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fl">5.5</span>),</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `size` argument of `element_rect()` is deprecated as of ggplot2 3.4.0.
ℹ Please use the `linewidth` argument instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `size` argument of `element_line()` is deprecated as of ggplot2 3.4.0.
ℹ Please use the `linewidth` argument instead.</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>pa</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `freq_cum$Returns` is discouraged.
ℹ Use `Returns` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="test2_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="interactive-pareto-chart" class="level4">
<h4 class="anchored" data-anchor-id="interactive-pareto-chart"><strong>INTERACTIVE PARETO CHART</strong></h4>
<p>From the previous chart plotted using <strong>ggplot2</strong>, the secondary y axes was based on a one-to-one transformation of the primary y axes. The bar and line charts were plotted with reference to the primary y axes, hence the secondary y axes will not be transferred to the interactive chart using <em>ggplotly()</em> of <strong>plotly</strong> library.</p>
<p>Therefore, an interactive pareto chart was plotted using <em>plot_ly()</em> from <strong>plotly</strong>. A scatter plot was not included in this case as one can simply hover across the line to view the corresponding cumulative percentage for each product. Similarly, hovering on the bars will reveal the absolute frequency of returns for each product sub-category.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(freq_cum, <span class="at">x =</span> <span class="sc">~</span><span class="fu">reorder</span>(<span class="st">`</span><span class="at">Sub-Category</span><span class="st">`</span>,<span class="sc">-</span><span class="st">`</span><span class="at">Returns</span><span class="st">`</span>), <span class="at">y =</span> <span class="sc">~</span><span class="st">`</span><span class="at">Returns</span><span class="st">`</span>, <span class="at">type =</span> <span class="st">"bar"</span>, <span class="at">name =</span> <span class="st">"Returns"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span><span class="fu">reorder</span>(<span class="st">`</span><span class="at">Sub-Category</span><span class="st">`</span>,<span class="sc">-</span><span class="st">`</span><span class="at">Returns</span><span class="st">`</span>), <span class="at">y =</span> <span class="sc">~</span><span class="st">`</span><span class="at">cum</span><span class="st">`</span><span class="sc">*</span><span class="dv">100</span>,<span class="at">type =</span> <span class="st">"scatter"</span>, <span class="at">mode =</span> <span class="st">"lines"</span>, <span class="at">yaxis =</span> <span class="st">"y2"</span>, <span class="at">name =</span> <span class="st">"Cum. %"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Pareto chart of returns by sub-category"</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Sub-Category"</span>),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Returns (Absolute Frequency)"</span>, <span class="at">showgrid =</span> F),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis2 =</span> <span class="fu">list</span>(<span class="at">overlaying =</span> <span class="st">"y"</span>, <span class="at">side =</span> <span class="st">"right"</span>, <span class="at">title =</span> <span class="st">"Cumulative Percentage (%)"</span>, <span class="at">range =</span> <span class="fu">list</span>(<span class="dv">0</span>, <span class="dv">100</span>)),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">orientation=</span><span class="st">"h"</span>, <span class="at">yanchor=</span><span class="st">"bottom"</span>,<span class="at">y=</span><span class="fl">0.9</span>,<span class="at">xanchor=</span><span class="st">"top"</span>,<span class="at">x=</span><span class="fl">0.2</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-4be6a0b1e533a88a04e7" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-4be6a0b1e533a88a04e7">{"x":{"visdat":{"737c5bc56ae8":["function () ","plotlyVisDat"]},"cur_data":"737c5bc56ae8","attrs":{"737c5bc56ae8":{"x":{},"y":{},"name":"Returns","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"},"737c5bc56ae8.1":{"x":{},"y":{},"name":"Cum. %","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","mode":"lines","yaxis":"y2","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Pareto chart of returns by sub-category","xaxis":{"domain":[0,1],"automargin":true,"title":"Sub-Category","type":"category","categoryorder":"array","categoryarray":["Binders","Paper","Phones","Furnishings","Accessories","Chairs","Storage","Appliances","Art","Tables","Fasteners","Labels","Supplies","Machines","Bookcases","Envelopes","Copiers"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Returns (Absolute Frequency)","showgrid":false},"yaxis2":{"overlaying":"y","side":"right","title":"Cumulative Percentage (%)","range":[0,100]},"legend":{"orientation":"h","yanchor":"bottom","y":0.9,"xanchor":"top","x":0.2},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Binders","Paper","Phones","Furnishings","Accessories","Chairs","Storage","Appliances","Art","Tables","Fasteners","Labels","Supplies","Machines","Bookcases","Envelopes","Copiers"],"y":[552,487,309,266,251,238,233,177,177,116,94,80,69,55,51,50,21],"name":"Returns","type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Binders","Paper","Phones","Furnishings","Accessories","Chairs","Storage","Appliances","Art","Tables","Fasteners","Labels","Supplies","Machines","Bookcases","Envelopes","Copiers"],"y":[17.1109733415995,32.2070675759454,41.7854928704278,50.0309981401116,57.8115313081215,65.1890886546807,72.411655300682,77.898326100434,83.384996900186,86.9807811531308,89.8946063236206,92.374457532548,94.513329200248,96.2182269063856,97.7991320520769,99.3490390576565,100],"name":"Cum. %","type":"scatter","mode":"lines","yaxis":"y2","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="insights-from-visualisation" class="level4">
<h4 class="anchored" data-anchor-id="insights-from-visualisation"><strong>INSIGHTS FROM VISUALISATION</strong></h4>
<p>From the pareto chart, we can tell that 8 sub-categories account for 80% of the returned products. The sub-categories are Binders, Paper, Phones, Furnishings, Accessories, Chairs, Storage, Appliances and Art. As these are about 50% of the product sub-categories, the distribution of returns across can be considered relatively even. The store owners can still use the chart to focus on products with high returns such as Binders and Paper.</p>
</section>
</section>
<section id="population-pyramid" class="level2">
<h2 class="anchored" data-anchor-id="population-pyramid"><strong>3.2. Population Pyramid</strong></h2>
<p>A <a href="https://en.wikipedia.org/wiki/Population_pyramid">population pyramid</a> depicts the distribution of a population by age groups and sex. The pyramid can be used to visualize the age of a particular population. It is also used determine the overall age distribution of a population and an indication of the reproductive capabilities and likelihood of the continuation of a species.</p>
<section id="import-dataset" class="level3">
<h3 class="anchored" data-anchor-id="import-dataset"><strong>3.2.1 Import Dataset</strong></h3>
<p>For this task, the data entitled Singapore Residents by Planning Area / Subzone, Age Group, Sex and Type of Dwelling, June 2021 should is used. The data set is available at <a href="https://www.singstat.gov.sg/">Department of Statistics home page</a>.</p>
<p>Data import was accomplished using <em>read_csv()</em> of <strong>readr</strong> package, which is useful for reading delimited files into a tibble.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/respopagesexfa2022.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 75696 Columns: 7
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (5): PA, SZ, AG, Sex, FA
dbl (2): Pop, Time

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  PA         SZ                     AG     Sex   FA              Pop  Time
  &lt;chr&gt;      &lt;chr&gt;                  &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt;
1 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males &lt;= 60             0  2022
2 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males &gt;60 to 80        10  2022
3 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males &gt;80 to 100       20  2022
4 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males &gt;100 to 120      60  2022
5 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males &gt;120             10  2022
6 Ang Mo Kio Ang Mo Kio Town Centre 0_to_4 Males Not Available     0  2022</code></pre>
</div>
</div>
</section>
<section id="data-wrangling-1" class="level3">
<h3 class="anchored" data-anchor-id="data-wrangling-1">** 3.2.2 Data Wrangling**</h3>
<section id="compute-the-frequency-count-by-age-and-sex" class="level4">
<h4 class="anchored" data-anchor-id="compute-the-frequency-count-by-age-and-sex"><strong>COMPUTE THE FREQUENCY COUNT BY AGE AND SEX</strong></h4>
<p>First, we are going to compute the frequency count of the total population in Singapore by gender and age. In the code chunk below, <em>group_by()</em> of <strong>dplyr</strong> package is used to group the orders by age and gender. Then, <em>summarise()</em> of <strong>dplyr</strong> is used to count (i.e.&nbsp;n()) the number of residents.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>freq_pop <span class="ot">&lt;-</span> pop <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">`</span><span class="at">AG</span><span class="st">`</span>, <span class="st">`</span><span class="at">Sex</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">'Count'</span><span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Pop</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'AG'. You can override using the `.groups`
argument.</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(freq_pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  AG       Sex      Count
  &lt;chr&gt;    &lt;chr&gt;    &lt;dbl&gt;
1 0_to_4   Females  87370
2 0_to_4   Males    91170
3 10_to_14 Females  99450
4 10_to_14 Males   103350
5 15_to_19 Females 101340
6 15_to_19 Males   105580</code></pre>
</div>
</div>
</section>
<section id="sort-data-table" class="level4">
<h4 class="anchored" data-anchor-id="sort-data-table"><strong>SORT DATA TABLE</strong></h4>
<p>By default, the values of the tibble data frame is sorted according to the values of the first column. In this case, the values are sorted alphanumerically by the age group.</p>
<p>Hence, we will sort the data based on the categorical age-group assigned in the original dataset. This task is first performed by changing the order using <em>mutate()</em> and then sorting via <em>arrange()</em> of <strong>dplyr</strong> package.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"0_to_4"</span>, <span class="st">"5_to_9"</span>, <span class="st">"10_to_14"</span>, <span class="st">"15_to_19"</span>, <span class="st">"20_to_24"</span>, <span class="st">"25_to_29"</span>, <span class="st">"30_to_34"</span>, <span class="st">"35_to_39"</span>, <span class="st">"40_to_44"</span>, <span class="st">"45_to_49"</span>, <span class="st">"50_to_54"</span>, <span class="st">"55_to_59"</span>, <span class="st">"60_to_64"</span>, <span class="st">"65_to_69"</span>, <span class="st">"70_to_74"</span>, <span class="st">"75_to_79"</span>, <span class="st">"80_to_84"</span>, <span class="st">"85_to_89"</span>, <span class="st">"90_and_over"</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>sorted_pop <span class="ot">&lt;-</span> freq_pop <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AG =</span>  <span class="fu">factor</span>(AG, <span class="at">levels =</span> order)) <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(AG)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sorted_pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  AG       Sex      Count
  &lt;fct&gt;    &lt;chr&gt;    &lt;dbl&gt;
1 0_to_4   Females  87370
2 0_to_4   Males    91170
3 5_to_9   Females  98430
4 5_to_9   Males   103530
5 10_to_14 Females  99450
6 10_to_14 Males   103350</code></pre>
</div>
</div>
</section>
</section>
<section id="plot-age-sex-population-pyramid" class="level3">
<h3 class="anchored" data-anchor-id="plot-age-sex-population-pyramid"><strong>3.2.3 Plot Age-Sex Population Pyramid</strong></h3>
<section id="static-age-sex-population-pyramid" class="level4">
<h4 class="anchored" data-anchor-id="static-age-sex-population-pyramid"><strong>STATIC AGE-SEX POPULATION PYRAMID</strong></h4>
<p>A Age-Sex Population Pyramid was plotted using <strong>ggplot2</strong> as follows:</p>
<ul>
<li><p><em>geom_col()</em> instead of <em>geom_bar()</em> was used to create the bar chart as we do not need to modify the data, and want the length of the bar to represent the actual population stats.</p></li>
<li><p><em>ifelse()</em> of Base R function was convert population count of Male residents to be negative, so that their data will be plotted on the left side of the pyramid.</p></li>
<li><p><em>scale_x_continuous()</em> was used to modify the labels on the x-axis to provide better readability.</p></li>
</ul>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sorted_pop, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">ifelse</span>(Sex <span class="sc">==</span> <span class="st">"Males"</span>, <span class="at">yes =</span> <span class="sc">-</span>Count, <span class="at">no =</span> Count), </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> AG, <span class="at">fill =</span> Sex)) <span class="sc">+</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">150000</span>, <span class="dv">150000</span>, <span class="dv">50000</span>), </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">paste0</span>(<span class="fu">as.character</span>(<span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">150</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">50</span>), <span class="fu">seq</span>(<span class="dv">50</span>, <span class="dv">150</span>, <span class="dv">50</span>))),<span class="st">"k"</span>)) <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">x =</span> <span class="st">"Population"</span>, <span class="at">y =</span> <span class="st">"Age"</span>, <span class="at">title=</span><span class="st">'Singapore Age-Sex Population Pyramid 2021'</span>) <span class="sc">+</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Males"</span> <span class="ot">=</span> <span class="st">"lightblue"</span>, <span class="st">"Females"</span> <span class="ot">=</span> <span class="st">"lightpink"</span>))</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="test2_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="interactive-age-sex-population-pyramid" class="level4">
<h4 class="anchored" data-anchor-id="interactive-age-sex-population-pyramid"><strong>INTERACTIVE AGE-SEX POPULATION PYRAMID</strong></h4>
<p>The static pyramid was converted to an interactive chart by using <em>ggplotly()</em> of the <strong>plotly</strong> library. By hovering your mouse on the bars, you can view the population stats for each age group and gender.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p,<span class="at">session=</span><span class="st">"knitr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-9fe7bac198637d7b8d1a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9fe7bac198637d7b8d1a">{"x":{"data":[{"orientation":"v","width":[87370,98430,99450,101340,113630,140510,164210,153790,157520,157150,150570,150870,144920,126220,98720,57850,44020,23860,16010],"base":[0.55,1.55,2.55,3.55,4.55,5.55,6.55,7.55,8.55,9.55,10.55,11.55,12.55,13.55,14.55,15.55,16.55,17.55,18.55],"x":[43685,49215,49725,50670,56815,70255,82105,76895,78760,78575,75285,75435,72460,63110,49360,28925,22010,11930,8005],"y":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999],"text":["ifelse(Sex == \"Males\", yes = -Count, no = Count):   87370<br />AG: 0_to_4<br />Sex: Females","ifelse(Sex == \"Males\", yes = -Count, no = Count):   98430<br />AG: 5_to_9<br />Sex: Females","ifelse(Sex == \"Males\", yes = -Count, no = Count):   99450<br />AG: 10_to_14<br />Sex: Females","ifelse(Sex == \"Males\", yes = -Count, no = Count):  101340<br />AG: 15_to_19<br />Sex: Females","ifelse(Sex == \"Males\", yes = -Count, no = Count):  113630<br />AG: 20_to_24<br />Sex: Females","ifelse(Sex == \"Males\", yes = -Count, no = Count):  140510<br />AG: 25_to_29<br />Sex: Females","ifelse(Sex == \"Males\", yes = -Count, no = Count):  164210<br />AG: 30_to_34<br />Sex: Females","ifelse(Sex == \"Males\", yes = -Count, no = Count):  153790<br />AG: 35_to_39<br />Sex: Females","ifelse(Sex == \"Males\", yes = -Count, no = Count):  157520<br />AG: 40_to_44<br />Sex: Females","ifelse(Sex == \"Males\", yes = -Count, no = Count):  157150<br />AG: 45_to_49<br />Sex: Females","ifelse(Sex == \"Males\", yes = -Count, no = Count):  150570<br />AG: 50_to_54<br />Sex: Females","ifelse(Sex == \"Males\", yes = -Count, no = Count):  150870<br />AG: 55_to_59<br />Sex: Females","ifelse(Sex == \"Males\", yes = -Count, no = Count):  144920<br />AG: 60_to_64<br />Sex: Females","ifelse(Sex == \"Males\", yes = -Count, no = Count):  126220<br />AG: 65_to_69<br />Sex: Females","ifelse(Sex == \"Males\", yes = -Count, no = Count):   98720<br />AG: 70_to_74<br />Sex: Females","ifelse(Sex == \"Males\", yes = -Count, no = Count):   57850<br />AG: 75_to_79<br />Sex: Females","ifelse(Sex == \"Males\", yes = -Count, no = Count):   44020<br />AG: 80_to_84<br />Sex: Females","ifelse(Sex == \"Males\", yes = -Count, no = Count):   23860<br />AG: 85_to_89<br />Sex: Females","ifelse(Sex == \"Males\", yes = -Count, no = Count):   16010<br />AG: 90_and_over<br />Sex: Females"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,182,193,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Females","legendgroup":"Females","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[91170,103530,103350,105580,119610,139910,153450,137670,142590,147600,143020,149390,143660,121800,90260,48360,31180,14110,6950],"base":[0.55,1.55,2.55,3.55,4.55,5.55,6.55,7.55,8.55,9.55,10.55,11.55,12.55,13.55,14.55,15.55,16.55,17.55,18.55],"x":[-45585,-51765,-51675,-52790,-59805,-69955,-76725,-68835,-71295,-73800,-71510,-74695,-71830,-60900,-45130,-24180,-15590,-7055,-3475],"y":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999],"text":["ifelse(Sex == \"Males\", yes = -Count, no = Count):  -91170<br />AG: 0_to_4<br />Sex: Males","ifelse(Sex == \"Males\", yes = -Count, no = Count): -103530<br />AG: 5_to_9<br />Sex: Males","ifelse(Sex == \"Males\", yes = -Count, no = Count): -103350<br />AG: 10_to_14<br />Sex: Males","ifelse(Sex == \"Males\", yes = -Count, no = Count): -105580<br />AG: 15_to_19<br />Sex: Males","ifelse(Sex == \"Males\", yes = -Count, no = Count): -119610<br />AG: 20_to_24<br />Sex: Males","ifelse(Sex == \"Males\", yes = -Count, no = Count): -139910<br />AG: 25_to_29<br />Sex: Males","ifelse(Sex == \"Males\", yes = -Count, no = Count): -153450<br />AG: 30_to_34<br />Sex: Males","ifelse(Sex == \"Males\", yes = -Count, no = Count): -137670<br />AG: 35_to_39<br />Sex: Males","ifelse(Sex == \"Males\", yes = -Count, no = Count): -142590<br />AG: 40_to_44<br />Sex: Males","ifelse(Sex == \"Males\", yes = -Count, no = Count): -147600<br />AG: 45_to_49<br />Sex: Males","ifelse(Sex == \"Males\", yes = -Count, no = Count): -143020<br />AG: 50_to_54<br />Sex: Males","ifelse(Sex == \"Males\", yes = -Count, no = Count): -149390<br />AG: 55_to_59<br />Sex: Males","ifelse(Sex == \"Males\", yes = -Count, no = Count): -143660<br />AG: 60_to_64<br />Sex: Males","ifelse(Sex == \"Males\", yes = -Count, no = Count): -121800<br />AG: 65_to_69<br />Sex: Males","ifelse(Sex == \"Males\", yes = -Count, no = Count):  -90260<br />AG: 70_to_74<br />Sex: Males","ifelse(Sex == \"Males\", yes = -Count, no = Count):  -48360<br />AG: 75_to_79<br />Sex: Males","ifelse(Sex == \"Males\", yes = -Count, no = Count):  -31180<br />AG: 80_to_84<br />Sex: Males","ifelse(Sex == \"Males\", yes = -Count, no = Count):  -14110<br />AG: 85_to_89<br />Sex: Males","ifelse(Sex == \"Males\", yes = -Count, no = Count):   -6950<br />AG: 90_and_over<br />Sex: Males"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(173,216,230,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Males","legendgroup":"Males","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":40.1826484018265,"l":89.8630136986302},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Singapore Age-Sex Population Pyramid 2021","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-169333,180093],"tickmode":"array","ticktext":["150k","100k","50k","0k","50k","100k","150k"],"tickvals":[-150000,-100000,-50000,0,50000,100000,150000],"categoryorder":"array","categoryarray":["150k","100k","50k","0k","50k","100k","150k"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Population","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,19.6],"tickmode":"array","ticktext":["0_to_4","5_to_9","10_to_14","15_to_19","20_to_24","25_to_29","30_to_34","35_to_39","40_to_44","45_to_49","50_to_54","55_to_59","60_to_64","65_to_69","70_to_74","75_to_79","80_to_84","85_to_89","90_and_over"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19],"categoryorder":"array","categoryarray":["0_to_4","5_to_9","10_to_14","15_to_19","20_to_24","25_to_29","30_to_34","35_to_39","40_to_44","45_to_49","50_to_54","55_to_59","60_to_64","65_to_69","70_to_74","75_to_79","80_to_84","85_to_89","90_and_over"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Age","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"title":{"text":"Sex","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"737c4e5b4cdd":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"737c4e5b4cdd","visdat":{"737c4e5b4cdd":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="insights-from-visualisation-1" class="level4">
<h4 class="anchored" data-anchor-id="insights-from-visualisation-1"><strong>INSIGHTS FROM VISUALISATION</strong></h4>
<p>From the plot, we can tell that Singapore has a constrictive population because there is a lower percentage of younger people. This indicates declining birth rates in Singapore, since each succeeding age group is getting smaller and smaller. It may also represent a higher life expectancy for the older population. As Singapore enters into a silver economy, government bodies can use such data to put fourth appropriate measures and policies to manage its ageing population in the future.</p>


</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>