---
title: "Visualise Singapore trade balance of import and export regionally and at countries level"
subtitle: "from year 2020 January to 2022 December"
editor: visual
date:  18 Feb 2023
date-modified: "`r Sys.Date()`"
code-copy: true
execute: 
  echo: true
  eval: true
  warning: false
  error: false
website: 
    google-analytics: "G-PKMQ2W4ZRC"
format:
  html:
    code-overflow: wrap
    code-fold: true
    code-summary: "Show the code"
    css: styles.css
---

# **1. OVERVIEW**

The instruction for this visual analytics individual assignment is to -

" uncover the impact of COVID-19 as well as the global economic and political dynamic in 2022 on Singapore bi-lateral trade (i.e. Import, Export and Trade Balance) by using appropriate analytical visualisation techniques learned in **Lesson 6: It's About Time**.

Students are encouraged to apply appropriate interactive techniques to enhance user and data discovery experiences. "

## **1.1 Singapore Trade Performances**

Before conceptualising the approach to visualise Singapore trade performances, first needs to establish some basic understanding of the terms' definitions from the data source and the associated contexts thereof. In this assignment, the focus is on merchandise trading.

### 1.1.1 Definition of Merchandise Imports

Below is the definition of **Merchandise Imports** in the metadata provided by [Singapore Department of Statistics](https://www.singstat.gov.sg/find-data/search-by-theme/trade-and-investment/merchandise-trade/latest-data) :

" Refer to all goods brought into Singapore, except those specified as excluded under the Coverage section, irrespective of whether they are for consumption, for processing, for use in manufacturing, or for subsequent re-shipment to other countries.  

-   Merchandise imports are valued at **'CIF' (Cost, Insurance and Freight)**, that is, the value of goods at the frontier of the exporting country plus the cost of insurance and freight and any other charges when sold for export to Singapore. "

### 1.1.2 Definition of Merchandise Exports

Separately, **Merchandise Exports** in the metadata is defined as :

" Refer to all goods taken out of Singapore, except those specified as excluded under the Coverage section.

-   It comprises **domestic exports** & **re-exports**.

-   Merchandise exports are **valued at 'FOB' (Free On Board)**, that is, the value of goods when sold abroad up to the point where the goods are deposited on board the outgoing vessel, aircraft or vehicle.

### 1.1.3 Definition of Re-Exports

From the metadata, re-exports refers to all goods exported from Singapore in the same form as they have been imported (including goods that have undergone minor processing, such as re-packing, splitting into lots, sorting or grading, marking and the like).

### 1.1.4 Key Merchandise Trade

Generally, there are two key types of merchandise traded by Singapore, i.e. oil (petroleum and oil bunkers) and non-oil merchandise which consists of the following **top 5 [major commodity sections traded in year 2022](https://www.singstat.gov.sg/modules/infographics/singapore-international-trade)**[^1] :

[^1]: Singapore Department of Statistics. 2023. Singapore's International Trade. https://www.singstat.gov.sg/modules/infographics/singapore-international-trade

+------------------------------------+----------------------+----------------------+
| Sections                           | Exports              | Imports              |
+====================================+======================+======================+
| Machinery & Transport Equipment    | S\$363.5 Bil (63.1%) | S\$319.0 Bil (62.6%) |
+------------------------------------+----------------------+----------------------+
| Chemicals & Chemical Products      | S\$83 Bil (14.4%)    | S\$52.3 Bil (10.3%)  |
+------------------------------------+----------------------+----------------------+
| Miscellaneous Manufactured Articls | S\$56.4 Bil (9.8%)   | S\$52.8 Bil (10.4%)  |
+------------------------------------+----------------------+----------------------+
| Manufactured Goods                 | S\$22.6 Bil (3.9%)   | S\$30.9 Bil (6.1%)   |
+------------------------------------+----------------------+----------------------+
| Food & Live Animals                | S\$15.2 Bil (2.6%)   | S\$14.0 Bil (2.7%)   |
+------------------------------------+----------------------+----------------------+

There are top 10 major trading partners ??!!

Main export partners -

China, 15%, China-Hong Kong 12%, Malaysia 11%, Indonesia 8%, United States 6%, Japan 5%

## 1.2 Scopes of Data Visualisation

The following are my focuses for this individual assignment, i.e. explore Singapore's trade performances via cycle plots and horizontal plots with various factors :

-   [**Overview with all countries**]{.underline} in the dataset (this is not the main focus, just to illustrate the difficulty of deriving valuable insights)

-   By [**6 Regions**]{.underline}.

-   By [**16 countries**]{.underline} instead of entire [G20 group members](https://www.g20.org/en/about-g20/).

    -   Exclude Russia

        -   [Singapore Ministry of Foreign Affairs](https://www.mfa.gov.sg/Newsroom/Press-Statements-Transcripts-and-Photos/2022/03/20220305-sanctions) announced on March 5, 2022, to impose appropriate sanctions and restrictions against Russia[^2]. Without data for the rest of the year 2022, thus, this study will explore the trading strength with G20, excluding Russia country.

    -   The dataset does not have trade data with South Africa and Türkiye.

    -   European Union consists of a block of European countries, some of which are G20 group members. Due to duplication, the visualisation won't be meaningful to represent the bi-lateral trading relationship thereof with Singapore. Hence, European Union will be excluded from G20 for this particular scope.

-   By [**ASEAN countries**]{.underline}.

-   By [**European Union countries**]{.underline} as indicated in the metadata.

[^2]: Singapore Ministry of Foreign Affairs. 2022. Sanctions and Restrictions Against Russia in Response to its Invasion of Ukraine. https://www.mfa.gov.sg/Newsroom/Press-Statements-Transcripts-and-Photos/2022/03/20220305-sanctions

# **2. R PACKAGE REQUIRED**

The following are the packages required for this exercise :

## **2.1 Load R Packages**

```{r}
#| code-fold: false
pacman::p_load(readxl, ggHoriPlot, ggthemes, ggpubr, ggiraph, lubridate, tidyverse, data.table, plotly, viridis, hrbrthemes, CGPfunctions, ggrepel)
```

# **3. DATA PROCESSING & PREPARATION**

## **3.1 Acquire Data Source**

This study will be based on the statistical time series of a merchandise trade data set compiled by Enterprise Singapore. The data set is available from [singstat.gov.sg](https://www.singstat.gov.sg/find-data/search-by-theme/trade-and-investment/merchandise-trade/latest-data).

-   Download the Excel data set from the link titled "Download all in Excel".

::: {.callout-tip collapse="true" appearance="simple" icon="false"}
## [**Highlights of the data set**]{style="color:#3a9c88"}

1.  The "Data Series" for both import and export datasets consist of a mixture of regions (unit in Million Dollars) and countries level (unit in Thousand Dollars) of data.
2.  Some countries appeared twice with different names. For example, "Germany, Federal Republic Of" and "Germany, Democratic Republic Of", or "Yemen" and "Yemen Democratic".
3.  The "European Union" consists of Austria, Belgium, Bulgaria, Croatia, Cyprus, Czech Rep, Denmark, Estonia, Finland, France, Germany, Greece, Hungary, Ireland, Italy, Latvia, Lithuania, Luxembourg, Malta, Netherlands, Poland, Portugal, Romania, Slovak Rep, Slovenia, Spain and Sweden.
    -   This data set does not include Croatia country.

        -   Remarks : Croatia only officially adopted European currency from the year 2023 onward.
4.  The data generation date is Feb 18, 2023.
:::

## **3.2 Import Data**

### **3.2.1 Import attributes data**

There are two (2) steps involve, which are import and inspect imported data set.

::: {.callout-tip collapse="true" appearance="simple" icon="false"}
## [**⇳ Usage of the code chunk below :**]{style="color:#3a9c88"}

[***read_xlsx( )*** - readxl -]{style="color:#d46e15"} to read Excel file into a tibble.

[***select( )*** - dplyr -]{style="color:#d46e15"} to retain columns specifically, "Data Series" and "contains" arguments for multiple column names "2019", "2020", "2021", and "2022".

-   Include both Dec and Nov in 2019 to compute the monthly differences for December 2019 before can compute the rate for "2020 Jan". Else, the value for "2020 Jan" will have "Null" value.

[***slice( )*** - dplyr -]{style="color:#d46e15"} to remove the first row with "Total Merchandise Imports" for *trade_import* or "Total Merchandise Exports" for *trade_export*.

[***problems( )*** - readr -]{style="color:#d46e15"} to reveal any parsing errors when importing the Excel file.
:::

#### 3.2.1.1 Read T1 as import dataset

```{r}
#| code-fold: false
trade_import <- read_excel("data/merchandiseTrade_region.xlsx",
                           sheet = "T1",
                           range = cell_rows(10:129)) %>%
  select(`Data Series`, contains(c("2019","2020", "2021", "2022"))) %>%
  slice(-1) %>%
  select(-(4:13))
  
problems(trade_import)
```

#### 3.2.1.2 Read T1 as export dataset

```{r}
#| code-fold: false
trade_export <-  read_xlsx("data/merchandiseTrade_region.xlsx",
                           sheet = "T2",
                           range = cell_rows(10:101)) %>% 
  select(`Data Series`, contains(c("2019", "2020", "2021", "2022"))) %>%
  slice(-1) %>%
  select(-(4:13))

problems(trade_export)
```

### **3.2.2 Inspect missing values**

#### 3.2.2.1 review *import* dataframe

```{r}
skimr::skim(trade_import)
```

#### 3.2.2.1 review *import* dataframe

```{r}
skimr::skim(trade_export)
```

## 3.3 Wrangle Data

### 3.3.1 Trim "Data Series" values

::: {.callout-tip collapse="true" appearance="simple" icon="false"}
## [**⇳ Usage of the code chunk below :**]{style="color:#3a9c88"}

[***separate( )*** - tidyr -]{style="color:#d46e15"} to split "Data Series" into 2 new fields "country" and "unit". This step will help shorten the country name when displayed in the horizontal chart to avoid unnecessary junk space.

[***str_remove( )*** - stringr -]{style="color:#d46e15"} to remove parenthesis " ( ) " from the "unit" column.
:::

#### 3.3.1.1 For *trade_import* dataframe

```{r}
trade_imports <- trade_import %>%
  separate(`Data Series`, c("country", "unit"),
           sep = ' \\(') %>%
  mutate(unit = str_remove(unit, '\\)'))
```

#### 3.3.1.2 For *trade_export* dataframe

```{r}
trade_exports <- trade_export %>%
  separate(`Data Series`, c("country", "unit"),
           sep = ' \\(') %>%
  mutate(unit = str_remove(unit, '\\)'))
```

### 3.3.2 Remove "country" with 0 values

::: {.callout-tip collapse="true" appearance="simple" icon="false"}
## [**⇳ Usage of the code chunk below :**]{style="color:#3a9c88"}

[***slice( )*** - dplyr -]{style="color:#d46e15"} to remove "Germany, Democratic Republic Of" and "Yemen Democratic" that have 0 value for the entire 3 years.
:::

#### 3.3.2.1 For *trade_imports* dataframe

```{r}
#| code-fold: false
trade_imports <- trade_imports %>%
  slice(-26, -70)
```

#### 3.3.2.2 For *trade_exports* dataframe

```{r}
#| code-fold: false
trade_exports <- trade_exports %>%
  slice(-24, -68)
```

### 3.3.3 Derive regions and countries level data frames

Rows with "Million Dollars" as the "unit" value represents data at regions level while "Thousand Dollars" represents countries level.

::: {.callout-tip collapse="true" appearance="simple" icon="false"}
## [**⇳ Usage of the code chunk below :**]{style="color:#3a9c88"}

[***str_detect( )*** - stringr -]{style="color:#d46e15"} to separate data table at countries level and regions level.

[***slice( )*** - dplyr -]{style="color:#d46e15"} to remove "Germany, Democratic Republic Of" and "Yemen Democratic" that have 0 value for the entire 2 years.
:::

#### 3.3.3.1 For import data at countries level

```{r}
#| code-fold: false
trade_importsK <- trade_imports %>%
  filter(str_detect(unit, "Thousand")) %>%
  select(-(unit))
```

#### 3.3.3.2 For import data at regions level

```{r}
#| code-fold: false
trade_importsM <- trade_imports %>%
  filter(str_detect(unit, "Million")) %>%
  select(-(unit))
```

#### 3.3.3.3 For export data at countries level

```{r}
#| code-fold: false
trade_exportsK <- trade_exports %>%
  filter(str_detect(unit, "Thousand")) %>%
  select(-(unit))
```

#### 3.3.3.4 For export data at regions level

```{r}
#| code-fold: false
trade_exportsM <- trade_exports %>%
  filter(str_detect(unit, "Million")) %>%
  select(-(unit))
```

### 3.3.4 Pivot data frames

::: {.callout-tip collapse="true" appearance="simple" icon="false"}
## [**⇳ Usage of the code chunk below :**]{style="color:#3a9c88"}

[***pivot_longer( )*** - tidyr -]{style="color:#d46e15"} to pivot data by reducing all year-month columns into a single column. This step is needed to compute the rate.

Arguments :

-   "cols" refers to all columns need to be reshaped except "country".

-   "names_to" is a new variable name, "temporary" to capture all the year-month of trades.

-   "values_to" is a new variable name, "import" or "export" to store all the traded values.

The code chunk is with reference to [cran.r-project](https://cran.r-project.org/web/packages/tidyr/vignettes/pivot.html)[^3].

[***arrange( )*** - dplyr -]{style="color:#d46e15"} to sort order of the rows by the values of "country" and "period".

[***relocate( )*** - dplyr -]{style="color:#d46e15"} to place "period" as the first column.
:::

[^3]: Pivoting. cran.r-project.org. https://cran.r-project.org/web/packages/tidyr/vignettes/pivot.html

#### 3.3.4.1 Pivot imports at countries level

```{r}
importK_pvL <- trade_importsK %>%
  pivot_longer(cols = !country,
               names_to = "temporary",
               values_to = "import") %>%
  mutate(period = (lubridate::ym(temporary))) %>%
  arrange(country, period)

importK_pvL <- importK_pvL %>%
  mutate(month = factor(month
                        (importK_pvL$`period`),
                        levels = 1:12, 
                        labels = month.abb, 
                        ordered = TRUE)) %>%
  mutate(year = as.character(year(ymd(importK_pvL$`period`)))) %>%
  relocate(year, month) %>%
  select(-temporary)
```

#### 3.3.4.2 Pivot imports at countries level

```{r}
importM_pvL <- trade_importsM %>%
  pivot_longer(cols = !country,
               names_to = "temporary",
               values_to = "import") %>%
  mutate(period = (lubridate::ym(temporary))) %>%
  arrange(country, period) 

importM_pvL <- importM_pvL %>%
  mutate(month = factor(month
                        (importM_pvL$`period`),
                        levels = 1:12, 
                        labels = month.abb, 
                        ordered = TRUE)) %>%
  mutate(year = as.character(year(ymd(importM_pvL$`period`)))) %>%
  relocate(year, month) %>%
  select(-temporary)
```

Remarks :

The "period" will be displayed alphabetically based on the months if arranged without first mutating the values with *ym* function from the lubridate package.

For example, 2020 Apr be displayed first, followed by 2020 Aug, 2020 Dec, 2020 Feb...

#### 3.3.4.3 Pivot exports at countries level

```{r}
exportK_pvL <- trade_exportsK %>%
  pivot_longer(cols = !country,
               names_to = 'temporary',
               values_to = "export") %>%
  mutate(period = (lubridate::ym(temporary))) %>%
  arrange(country, period) 

exportK_pvL <- exportK_pvL %>%
  mutate(month = factor(month
                        (exportK_pvL$`period`),
                        levels = 1:12, 
                        labels = month.abb, 
                        ordered = TRUE)) %>%
  mutate(year = as.character(year(ymd(exportK_pvL$`period`)))) %>%
  relocate(year, month) %>%
  select(-temporary)
```

#### 3.3.4.4 Pivot exports at regions level

```{r}
#| code-fold: false
exportM_pvL <- trade_exportsM %>%
  pivot_longer(cols = !country,
               names_to = "temporary",
               values_to = "export") %>%
  mutate(period = (lubridate::ym(temporary))) %>%
  arrange(country, period)

exportM_pvL <- exportM_pvL %>%
  mutate(month = factor(month
                        (exportM_pvL$`period`),
                        levels = 1:12, 
                        labels = month.abb, 
                        ordered = TRUE)) %>%
  mutate(year = as.character(year(ymd(exportM_pvL$`period`)))) %>%
  relocate(year, month) %>%
  select(-temporary)
```

### 3.3.5 Merge data frames

::: {.callout-tip collapse="true" appearance="simple" icon="false"}
## [**⇳ Usage of the code chunk below :**]{style="color:#3a9c88"}

[***full_join( )*** - dplyr -]{style="color:#d46e15"} to keep all observations in both import and export data frames.

[***replace_na( )*** - tidyr -]{style="color:#d46e15"} to replace NAs with 0 value.
:::

#### 3.3.5.1 Trade data at countries level

```{r}
tradesK<- importK_pvL %>% 
  full_join(exportK_pvL)
```

#### 3.3.5.2 Countries with no export data

```{r}
noExport <- tradesK %>% 
  filter(is.na(export)) 

unique(noExport$country)
```

#### 3.3.5.3 Trade data at regions level

```{r}
tradesM<- importM_pvL %>% 
  full_join(exportM_pvL) %>%
  rename(`region` = 3) %>%
  filter(!region %in% "European Union")
```

### 3.3.6 Compute new variables

Derive the following variables :

-   "tradeTotal" for total merchandise traded, each row's value is the sum of "import" and "export".

-   "bot" is the abbreviation of "Balance of Trade", subtract "import" from the value of "export".

    -   "Trade Surplus" is when Singapore's export value higher than its import value, otherwise known as "Trade Deficit".

-   "rate" for monthly trend percentage.

#### 3.3.6.1 for country data frame

```{r}
#| code-fold: false
tradesK_bot <- tradesK %>%
  mutate(export = replace_na(export, 0)) %>%
  mutate(tradeTotal = export + import) %>%
  mutate(bot = export - import) %>%
  mutate(botMoM = bot - shift(bot)) %>%
  mutate(rateMoM = round(botMoM/shift(bot),
                         digits = 3)) %>%
  filter(!year == "2019")
```

#### 3.3.6.2 Drop countries without export data

::: {.callout-tip collapse="true" appearance="simple" icon="false"}
## [**⇳ Usage of the code chunk below :**]{style="color:#3a9c88"}

[***drop_na( )*** - tidyr -]{style="color:#d46e15"} to drop rows that has 0 value to avoid infinity value for the "rate" column.
:::

```{r}
tradesK_trim <- tradesK %>%
  drop_na(`export`) %>%
  mutate(tradeTotal = `export` + `import`) %>%
  mutate(bot = `export` - `import`) %>%
  mutate(botMoM = `bot` - shift(`bot`)) %>%
  mutate(rateMoM = round(
    (`botMoM`/shift(`bot`)),
    digits = 3)) %>%
  filter(!year == "2019")
```

#### 3.3.6.3 for regional data frame

```{r}
#| code-fold: false
tradesM_bot <- tradesM %>%
  mutate(tradeTotal = import + export) %>%
  mutate(bot = export - import) %>%
  mutate(botMoM = bot - shift(bot)) %>%
  mutate(rateMoM = round(
    (`botMoM`/shift(`bot`)),
    digits = 3)) %>%
  filter(!year == "2019")
```

## 3.4 Derive scoped data frames

The overview with all countries will be based on the *tradesK_bot* data frame, while the regional-level visualisation will be based on the *tradesM_bot* data frame. The rest data frames will be covered in this section.

### 3.4.1 G16 countries

```{r}
#| code-fold: false
g16 <- filter(tradesK_bot,
              country == "France" | country == "Germany, Federal Republic Of" |
                country == "Italy" | country == "Japan" | 
                country == "United Kingdom" | country == "United States" | 
                country == "Canada" | country == "Argentina" | 
                country == "Australia" | country == "Brazil" | 
                country == "Mainland China" | country == "India" | 
                country == "Indonesia" | country == "Mexico" | 
                country == "Republic Of Korea" | country == "Saudi Arabia")
```

### 3.4.2 ASEAN countries

Filter 9 ASEAN members regarding the [list of member-states](https://asean.org/member-states/) from asean.org.

```{r}
#| code-fold: false
asean <- filter(tradesK_bot,
                country == "Brunei Darussalam" | country == "Cambodia" |
                country == "Indonesia" | 
                country == "Laos People's Democratic Republic" | 
                country == "Malaysia" | country == "Myanmar" | 
                country == "Philippines" |
                country == "Thailand" | 
                country == "Vietnam, Socialist Republic Of")
```

### 3.4.3 European Union countries

Filter for the countries based on the metadata definition with different approaches.

```{r}
eUnion <- tradesK_bot %>%
  filter(grepl("Austria|Belgium|Bulgaria|Croatia|Cyprus|Czech Rep|Denmark|Estonia|Finland|France|Germany|Greece|Hungary|Ireland|Italy|Latvia|Lithuania|Luxembourg|Malta|Netherlands|Poland|Portugal|Romania|Slovak Rep|Slovenia|Spain|Sweden", country))
```

Remarks :

Avoid space between the countries' names and the pip "\|" character. Else, it will return with an empty data frame.

With references to the *noExport* data frame, only Bulgaria and Croatia don't have trade data.

## 3.5 Create data frame for cycles plot

### 3.5.1 Extract data by region

#### 3.5.1.1 Africa region

```{r}
africa <- tradesM_bot %>%
  filter(region == "Africa") %>%
  filter(!year == "2019")
```

#### 3.5.1.2 America region

```{r}
america <- tradesM_bot %>%
  filter(region == "America") %>%
  filter(!year == "2019")
```

#### 3.5.1.3 Asia region

```{r}
asia <- tradesM_bot %>%
  filter(region == "Asia") %>%
  filter(!year == "2019")
```

#### 3.5.1.4 Europe region

```{r}
europe <- tradesM_bot %>%
  filter(region == "Europe") %>%
  filter(!year == "2019")
```

#### 3.5.1.5 Oceania region

```{r}
oceania <- tradesM_bot %>%
  filter(region == "Oceania") %>%
  filter(!year == "2019")
```

### 3.5.2 Compute monthly average for each region

```{r}
hl_africa <- africa %>% 
  group_by(month) %>%
  summarise(avg = mean(tradeTotal))

hl_america <- america %>%
  group_by(month) %>%
  summarise(avg = mean(tradeTotal))

hl_asia <- asia %>%
  group_by(month) %>%
  summarise(avg = mean(tradeTotal))

hl_europe <- europe %>%
  group_by(month) %>%
  summarise(avg = mean(tradeTotal))

hl_oceania <- oceania %>%
  group_by(month) %>%
  summarise(avg = mean(tradeTotal))
```

## 3.6 Create Data Frame for Other Visualisation

```{r}
#| code-fold: false
exportTotal <- exportK_pvL %>%
  group_by(year, country) %>%
  summarise(volume_export = sum(export)) %>%
  filter(!year == "2019") %>%
  pivot_wider(names_from = year, 
              values_from = volume_export) %>%
  arrange(desc(`2022`))

glimpse(exportTotal, 60)
```

```{r}
asean_pvW <- asean %>%
  select(1:10) %>%
  gather(key = "tradeType", 
         value = "tradeVolume", -country, -period, -bot, -botMoM, -tradeTotal, -month, -year, -rateMoM)
```

```{r}
eUnion_pvW <- eUnion %>%
  select(1:10) %>%
  gather(key = "tradeType", 
         value = "tradeVolume", -country, -period, -bot, -botMoM, -tradeTotal, -month, -year, -rateMoM)

glimpse(eUnion_pvW, 60)
```

```{r}
germany <- eUnion_pvW %>%
  filter(country == "Germany, Federal Republic Of")
```

```{r}
asean_export <- asean %>%
  group_by(country, year) %>%
  summarise(volume_export = sum(export))
```

```{r}
asean_bot <- asean %>%
  group_by(country, year) %>%
  summarise(bot = sum(bot))
```

<br>

# 4. VISUAL ANALYSIS

## 4.1 Horizon Chart

### 4.1.1 Overview of Trade Balance (BOT) Fluctuation at Countries Level

This area-time series visualisation technique is used to reveal the trends of trade balance changes for 110 trading partners at the country level month-over-month from the year 2020 to 2022.

```{r}
#| fig-height: 20
#| fig-width: 14
overviewPlot_countries <- ggplot() + 
  geom_horizon(aes(period, rateMoM),
               data = tradesK_bot,
               origin = 0,
               horizonscale = c(-15, -5, -1, 0, 1, 5)) +
  scale_fill_hcl(palette = "RdBu") +
  facet_grid(country~.) +
  labs (x = "Period",
        title = "Overview of Singapore's Trade Balance Changes Month-over-Month",
        subtitle = " with 110 Countries from January 2020 to December 2022",
        caption = "Data Source : Singstat.gov.sg, 2023") +
  theme_few() +
  theme(plot.margin = margin(0.8, 0.5, 0.8, 0.5, "cm"),
        plot.title = element_text (size = 24, 
                                   colour = "#302f2f",
                                   face = "bold"),
        plot.subtitle = element_text(size = 12,
                                     colour = "#424242",
                                     face = "italic",
                                     margin = margin(0,0,10,0)),
        plot.caption = element_text(size = 10,
                                    colour = "#424242",
                                    hjust = 0,
                                    vjust = -3),
    panel.spacing.y = unit(0, "lines"),
    strip.text.y = element_text(size = 8, 
                                angle = 0, 
                                hjust = 0),
    axis.text.y = element_blank(),
    axis.title.y = element_blank(),
    axis.ticks.y = element_blank(),
    axis.ticks.x = element_line(colour = "#969595",
                                linewidth = 0.5),
    axis.text.x = element_text(size = 10, 
                               angle = 75, 
                               hjust = 0, 
                               vjust = -0.2),
    axis.title.x = element_blank(),
    panel.border = element_blank(),
    legend.position = "none") +
  scale_x_date(expand = c(0,0), 
               date_breaks = "1 month", 
               date_labels = "%b '%y",
               limit = c(as.Date("2020-01-01"),
                         as.Date("2022-12-31"))) +
  geom_vline(xintercept = as.Date("2022-11-16"), color = "limegreen", size = 1) + 
  geom_vline(xintercept = as.Date("2022-09-05"), color = "limegreen", size = 1) +
  geom_vline(xintercept = as.Date("2022-03-16"), color = "limegreen", size = 1) +
  geom_vline(xintercept = as.Date("2021-08-23"), color = "limegreen", size = 1) +
  geom_vline(xintercept = as.Date("2022-09-19"), color = "orange", size = 1) + 
  geom_vline(xintercept = as.Date("2022-09-11"), color = "orange", size = 1) +
  geom_vline(xintercept = as.Date("2022-08-01"), color = "orange", size = 1) +
  geom_vline(xintercept = as.Date("2022-06-22"), color = "orange", size = 1) +
  geom_vline(xintercept = as.Date("2022-06-14"), color = "orange", size = 1) +
  geom_vline(xintercept = as.Date("2022-05-26"), color = "orange", size = 1) +
  geom_vline(xintercept = as.Date("2022-02-24"), color = "orange", size = 1) +
  geom_vline(xintercept = as.Date("2021-02-24"), color = "purple", size = 1) +
  geom_vline(xintercept = as.Date("2021-01-07"), color = "purple", size = 1) +
  geom_vline(xintercept = as.Date("2020-12-01"), color = "purple", size = 1) +
  geom_vline(xintercept = as.Date("2022-04-26"), color = "red", size = 1) +
  geom_vline(xintercept = as.Date("2022-03-24"), color = "red", size = 1) +
  geom_vline(xintercept = as.Date("2021-11-26"), color = "red", size = 1) +
  geom_vline(xintercept = as.Date("2021-10-09"), color = "red", size = 1) +
  geom_vline(xintercept = as.Date("2021-05-08"), color = "red", size = 1) + 
  geom_vline(xintercept = as.Date("2020-11-09"), color = "red", size = 1) +
  geom_vline(xintercept = as.Date("2020-06-02"), color = "red", size = 1) +
  geom_vline(xintercept = as.Date("2020-04-07"), color = "red", size = 1) +
  geom_vline(xintercept = as.Date("2020-02-07"), color = "red", size = 1)

overviewPlot_countries
```

Remarks :

It is difficult and ineffective to visually identify patterns or insights by looking at the chart. Hence, various significant events and incidents are listed in the accordion below to facilitate the trend study and explain the fluctuation in BOT changes. However, despite these cross-references, the study can be ineffective and lacks credibility to justify the causality of the BOT fluctuation.

::: {.callout-tip collapse="true" appearance="simple" icon="false"}
## [**Date of Homeland Events - RED lines**]{style="color:#3a9c88"}

+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **2022 Apr 26**                                                                                                                                                                                      |
+======================================================================================================================================================================================================+
| **Singapore Disease Outbreak Response System Condition (DORSCON) Orange to Yellow**[^4]                                                                                                              |
|                                                                                                                                                                                                      |
| Further easing community policies (safe distancing, group size limit and events' capacity limit are lifted) and border measures.                                                                     |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                                                                                      |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **2022 Mar 24**                                                                                                                                                                                      |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Singapore Easing Community SMMs and Border Measures**                                                                                                                                              |
|                                                                                                                                                                                                      |
| Singapore Tasks Force eased the community Safe Management Measures (SMM) and border measures.                                                                                                        |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                                                                                      |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **2021 Nov 26**                                                                                                                                                                                      |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **OMICRON VARIANT OF COVID-19**                                                                                                                                                                      |
|                                                                                                                                                                                                      |
| On 26 Nov 2021, the World Health Organisation (WHO) announced the Omicron variant discovery of COVID-19.                                                                                             |
|                                                                                                                                                                                                      |
| -   While there was some dip to the stock market prices, due to lack of information on the virus, the impact seems to be lower than the Delta and Alpha variant of the virus for most companies.     |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                                                                                      |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **2021 Oct 09**                                                                                                                                                                                      |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **CAUTIOUS RE-OPENING WITH ENDEMIC COVID-19**                                                                                                                                                        |
|                                                                                                                                                                                                      |
| Since then, the nation has acknowledged that the Zero-Covid strategy is no longer feasible due to highly infectious variants formed.                                                                 |
|                                                                                                                                                                                                      |
| -   It has engaged a cautions re-opening strategy to enable Singaporeans to resume their lives, participate in social activities, open the borders and revive the economy.                           |
|                                                                                                                                                                                                      |
| -   One such example would be the Vaccinated Travel Lane (VTL) which allowed fully-vaccinated Singaporean citizens and permanent residents to return to Singapore without quarantine.                |
|                                                                                                                                                                                                      |
| -   On 9 Oct 2021, it was announced that Singapore would open up more VTLs with other countries, including South Korea and the United States.                                                        |
|                                                                                                                                                                                                      |
| -   This saw some rise in the stock market prices, especially companies who stand to gain most such as Singapore Airlines and SATS.                                                                  |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                                                                                      |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **2021 May 08**                                                                                                                                                                                      |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **DELTA WAVE OF COVID-19**                                                                                                                                                                           |
|                                                                                                                                                                                                      |
| By May 2021, the Delta variant of COVID-19 had widely spread, causing several clusters across the nation.                                                                                            |
|                                                                                                                                                                                                      |
| -   The re-opening efforts put forth by the Government were heldback, Singapore reverted back to Phase 2 from 8 May, which was subsequently tightened to Phase 2 Heightened Alert from 16 May.       |
|                                                                                                                                                                                                      |
| -   This tightening of measures caused the stock market prices to dip.                                                                                                                               |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                                                                                      |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **2020 Nov 09**                                                                                                                                                                                      |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **National Vaccination Campaign**                                                                                                                                                                    |
|                                                                                                                                                                                                      |
| Pfizer and BioNTech SE announced a vaccine candidate that has demonstrated evidence of efficacy against COVID-19.                                                                                    |
|                                                                                                                                                                                                      |
| -   Since Dec 2020, the National Vaccination Campaign commenced and in late 2021, Singapore became the world's most-vaccinated country, with more than 85% of its total population fully-vaccinated. |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                                                                                      |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **2020 Jun 02**                                                                                                                                                                                      |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Eased of circuit breaker**                                                                                                                                                                         |
|                                                                                                                                                                                                      |
| Enters its first phase of reopening, where businesses and activities are progressively allowed to resume, giving rise to some semblance of normalcy.                                                 |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                                                                                      |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **2020 Apr 07**                                                                                                                                                                                      |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Circuit breaker**                                                                                                                                                                                  |
|                                                                                                                                                                                                      |
| Introduced the Circuit Breaker period, where citizens practised enhanced social distancing and isolation.                                                                                            |
|                                                                                                                                                                                                      |
| -   Workplaces and schools closed and most shops shuttered.                                                                                                                                          |
|                                                                                                                                                                                                      |
| -   Businesses were badly impacted by the drop in footfall and consumption.                                                                                                                          |
|                                                                                                                                                                                                      |
| -   However, the stock market seem to be recovering from the crash in March.                                                                                                                         |
|                                                                                                                                                                                                      |
| -   One reason could be the implementation of the Budgets the Government has dedicated to support Singaporeans and businesses in the battle against COVID-19, which amounted close to \$100 billion. |
|                                                                                                                                                                                                      |
| -   Secondly, businesses were also adapting to the change in consumer patterns through contactless digital systems, which were well-received.                                                        |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                                                                                      |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **2020 Feb 07**                                                                                                                                                                                      |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Initial wave of Covid-19**                                                                                                                                                                         |
|                                                                                                                                                                                                      |
| Disease Outbreak Response System Condition (DORSCON) to orange, signalling that the disease is severe and there is widespread transmission from unknown sources.                                     |
|                                                                                                                                                                                                      |
| -   This is highest level ever reached since the SARS outbreak in 2003.                                                                                                                              |
|                                                                                                                                                                                                      |
| -   The severity of the pandemic caused panic and uncertainty amongst business and citizens.                                                                                                         |
|                                                                                                                                                                                                      |
| -   More countries were also entering a lockdown state to contain the spread, disrupting global trade flows which exacerbated the market.                                                            |
|                                                                                                                                                                                                      |
| -   Hence, spurring on the COVID-19 financial crash in March 2020, which not only impacted Singapore but all major stock markets as well.                                                            |
|                                                                                                                                                                                                      |
| -   The March 2020 COVID-19 crash was a short-lived bear market, and in April 2020 stock markets re-entered a bull market.                                                                           |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
:::

[^4]: Ministry of Health. 2022. Further easing of community and border measures. https://www.moh.gov.sg/news-highlights/details/further-easing-of-community-and-border-measures

::: {.callout-tip collapse="true" appearance="simple" icon="false"}
## [**Date of Global Affairs & High Economic Damages Catastrophe - ORANGE lines**]{style="color:#3a9c88"}

+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **2022 Sep**                                                                                                                                                                                                               |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [**Magnitude 7.6 earthquake in Papua New Guinea**](https://en.wikipedia.org/wiki/2022_Papua_New_Guinea_earthquake)                                                                                                         |
|                                                                                                                                                                                                                            |
| Power supply facilities across the region were damaged.                                                                                                                                                                    |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                                                                                                            |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **2022 Aug**                                                                                                                                                                                                               |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [**Severe drought in China**](https://www.washingtonpost.com/world/2022/08/16/china-heat-wave-climate-change-electricity/)                                                                                                 |
|                                                                                                                                                                                                                            |
| China authorities ordered factories in several major manufacturing regions to suspend production to conserve electricity.                                                                                                  |
|                                                                                                                                                                                                                            |
| [**Conflict and election-related violence in Papua New Guinea**](https://news.un.org/en/story/2022/09/1126051)                                                                                                             |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                                                                                                            |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **2022 June**                                                                                                                                                                                                              |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [**Deadliest earthquake in Afghanistan since 2002**](https://en.wikipedia.org/wiki/June_2022_Afghanistan_earthquake)                                                                                                       |
|                                                                                                                                                                                                                            |
| More than 25 villages were nearly decimated with a total of 10,000 homes were partially or totally destroyed.\                                                                                                             |
| \                                                                                                                                                                                                                          |
| [**Pakistan flood**](https://en.wikipedia.org/wiki/2022_Pakistan_floods) 10 to 12% of Pakistan was flooded. Damage cost up to ₨ 3.2 trillion (\$14.9 billion) while economic losses up to ₨ 3.3 trillion (\$15.2 billion). |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                                                                                                            |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 2022 May 29                                                                                                                                                                                                                |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Colombian Presidential election**                                                                                                                                                                                        |
|                                                                                                                                                                                                                            |
| ![](images/image-1543944568.png){width="400"}                                                                                                                                                                              |
|                                                                                                                                                                                                                            |
| The Colombian Peso to SGD been ????                                                                                                                                                                                        |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                                                                                                            |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **2022 Feb 24**                                                                                                                                                                                                            |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [**Russia invade Ukraine**](https://news.un.org/en/story/2022/02/1112592)                                                                                                                                                  |
|                                                                                                                                                                                                                            |
| President Putin announced the begin of Russian invasion through Ukraine's eastern Donbas region.[^5]                                                                                                                       |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
:::

[^5]: 2022\. As Security Council meets on Ukraine crisis, Russia announces start of 'special military operation'. UN News. https://news.un.org/en/story/2022/02/1112592

::: {.callout-tip collapse="true" appearance="simple" icon="false"}
## [**Date of Significant Changes to Some Currency - PURPLE lines**]{style="color:#3a9c88"}

+----------------------------------------------------------------------------------------------------------------------+
| **2021 Feb 24**                                                                                                      |
+----------------------------------------------------------------------------------------------------------------------+
| Australia, AUDSGD \~ \$1.05                                                                                          |
+----------------------------------------------------------------------------------------------------------------------+
|                                                                                                                      |
+----------------------------------------------------------------------------------------------------------------------+
| **2021 Jan 7**                                                                                                       |
+----------------------------------------------------------------------------------------------------------------------+
| **Bahrain, BHDSGD \~3.497**                                                                                          |
|                                                                                                                      |
| The lowest within study period. Noticed a dropped of rate up to 18% in the trade balance.                            |
+----------------------------------------------------------------------------------------------------------------------+
|                                                                                                                      |
+----------------------------------------------------------------------------------------------------------------------+
| **2020 Dec**                                                                                                         |
+----------------------------------------------------------------------------------------------------------------------+
| [**Yemeni currency, Rial,**](https://tradingeconomics.com/yemen/currency) hit lowest within 5 years as of year 2023. |
+----------------------------------------------------------------------------------------------------------------------+
:::

::: {.callout-tip collapse="true" appearance="simple" icon="false"}
## [**Date of SGP International Expo / Trade Shows Related to Export Industry - GREEN lines**]{style="color:#3a9c88"}

+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 2022 Nov 16 to 18                                                                                                                                                                                                                                                                                                                                                                                                    |
+======================================================================================================================================================================================================================================================================================================================================================================================================================+
| [**Architecture & Building Services 2022**](https://web.micepad.co/architecture--building-services-2022)                                                                                                                                                                                                                                                                                                             |
|                                                                                                                                                                                                                                                                                                                                                                                                                      |
| Singapore's largest construction fair. Exhibitors are able to discover the procurement needs of more than 10,000 trade visitors and professionals                                                                                                                                                                                                                                                                    |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                                                                                                                                                                                                                                                                                                      |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **2022 Oct 26 to 28**                                                                                                                                                                                                                                                                                                                                                                                                |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [**Glasstech Asia 2022**](https://web.micepad.co/glasstech-asia-2022)                                                                                                                                                                                                                                                                                                                                                |
|                                                                                                                                                                                                                                                                                                                                                                                                                      |
| This glass exhibition provides a platform to connect various regional glass manufacturing, processing, products and materials sectors.                                                                                                                                                                                                                                                                               |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|                                                                                                                                                                                                                                                                                                                                                                                                                      |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **2021 Aug 23 to 27**                                                                                                                                                                                                                                                                                                                                                                                                |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [**SEMICON Southeast Asia 2021**](https://web.micepad.co/semicon-southeast-asia-2021) **Singapore**                                                                                                                                                                                                                                                                                                                  |
|                                                                                                                                                                                                                                                                                                                                                                                                                      |
| SEMICON Southeast Asia is the region's premier platform for engaging microelectronics manufacturing technology, provides exceptional opportunities to learn and share information about the latest developments in microelectronics, including semiconductors, MEMS, LEDs and more. The SEMICON Southeast Asia will focus on the key trends and solutions in semiconductor design and manufacturing, including e\... |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
:::

### 4.1.2 Overview of Trade Balance (BOT) Fluctuation at Regions Level

```{r}
#| fig-height: 5
#| fig-width: 14
overviewPlot_regions <- ggplot() + 
  geom_horizon(aes(period, rateMoM),
               data = tradesM_bot,
               origin = 0,
               horizonscale = c(-15, -5, -1, 0, 1, 5)) +
  scale_fill_hcl(palette = "RdBu") +
  facet_grid(region~.) +
  labs (x = "Period",
        title = "Overview of Singapore's Trade Balance Changes Month-over-Month",
        subtitle = "with 5 regions from January 2020 to December 2022",
        caption = "Data Source : Singstat.gov.sg, 2023") +
  theme_few() +
  theme(plot.margin = margin(0.8, 0.5, 0.8, 0.5, "cm"),
        plot.title = element_text (size = 24, 
                                   colour = "#302f2f",
                                   face = "bold"),
        plot.subtitle = element_text(size = 12,
                                     colour = "#424242",
                                     face = "italic",
                                     margin = margin(0,0,10,0)),
        plot.caption = element_text(size = 10,
                                    colour = "#424242",
                                    hjust = 0,
                                    vjust = -3),
    panel.spacing.y = unit(0, "lines"),
    strip.text.y = element_text(size = 8, 
                                angle = 0, 
                                hjust = 0),
    axis.text.y = element_blank(),
    axis.title.y = element_blank(),
    axis.ticks.y = element_blank(),
    axis.ticks.x = element_line(colour = "#969595",
                                linewidth = 0.5),
    axis.text.x = element_text(size = 10, 
                               angle = 75, 
                               hjust = 0, 
                               vjust = -0.2),
    axis.title.x = element_blank(),
    panel.border = element_blank(),
    legend.position = "none") +
  scale_x_date(expand = c(0,0), 
               date_breaks = "1 month", 
               date_labels = "%b '%y",
               limit = c(as.Date("2020-01-01"),
                         as.Date("2022-12-31"))) +
  geom_vline(xintercept = as.Date("2022-11-16"), color = "limegreen", size = 1) + 
  geom_vline(xintercept = as.Date("2022-09-05"), color = "limegreen", size = 1) +
  geom_vline(xintercept = as.Date("2022-03-16"), color = "limegreen", size = 1) +
  geom_vline(xintercept = as.Date("2021-08-23"), color = "limegreen", size = 1) +
  geom_vline(xintercept = as.Date("2022-09-19"), color = "orange", size = 1) + 
  geom_vline(xintercept = as.Date("2022-09-11"), color = "orange", size = 1) +
  geom_vline(xintercept = as.Date("2022-08-01"), color = "orange", size = 1) +
  geom_vline(xintercept = as.Date("2022-06-22"), color = "orange", size = 1) +
  geom_vline(xintercept = as.Date("2022-06-14"), color = "orange", size = 1) +
  geom_vline(xintercept = as.Date("2022-05-26"), color = "orange", size = 1) +
  geom_vline(xintercept = as.Date("2022-02-24"), color = "orange", size = 1) +
  geom_vline(xintercept = as.Date("2021-02-24"), color = "purple", size = 1) +
  geom_vline(xintercept = as.Date("2021-01-07"), color = "purple", size = 1) +
  geom_vline(xintercept = as.Date("2020-12-01"), color = "purple", size = 1) +
  geom_vline(xintercept = as.Date("2022-04-26"), color = "red", size = 1) +
  geom_vline(xintercept = as.Date("2022-03-24"), color = "red", size = 1) +
  geom_vline(xintercept = as.Date("2021-11-26"), color = "red", size = 1) +
  geom_vline(xintercept = as.Date("2021-10-09"), color = "red", size = 1) +
  geom_vline(xintercept = as.Date("2021-05-08"), color = "red", size = 1) + 
  geom_vline(xintercept = as.Date("2020-11-09"), color = "red", size = 1) +
  geom_vline(xintercept = as.Date("2020-06-02"), color = "red", size = 1) +
  geom_vline(xintercept = as.Date("2020-04-07"), color = "red", size = 1) +
  geom_vline(xintercept = as.Date("2020-02-07"), color = "red", size = 1)

overviewPlot_regions
```

<br>

### 4.1.3 BOT fluctuation by ASEAN members

```{r}
#| fig-height: 5
#| fig-width: 14
asean_horPlot <- ggplot() + 
  geom_horizon(aes(period, rateMoM),
               data = asean,
               origin = 0,
               horizonscale = c(-15, -5, -1, 0, 1, 5)) +
  scale_fill_hcl(palette = "RdBu") +
  facet_grid(country~.) +
  labs (x = "Period",
        title = "Overview of Singapore's Trade Balance Changes Month-over-Month",
        subtitle = "with ASEAN members from January 2020 to December 2022",
        caption = "Data Source : Singstat.gov.sg, 2023") +
  theme_few() +
  theme(plot.margin = margin(0.8, 0.5, 0.8, 0.5, "cm"),
        plot.title = element_text (size = 24, 
                                   colour = "#302f2f",
                                   face = "bold"),
        plot.subtitle = element_text(size = 12,
                                     colour = "#424242",
                                     face = "italic",
                                     margin = margin(0,0,10,0)),
        plot.caption = element_text(size = 10,
                                    colour = "#424242",
                                    hjust = 0,
                                    vjust = -3),
    panel.spacing.y = unit(0, "lines"),
    strip.text.y = element_text(size = 8, 
                                angle = 0, 
                                hjust = 0),
    axis.text.y = element_blank(),
    axis.title.y = element_blank(),
    axis.ticks.y = element_blank(),
    axis.ticks.x = element_line(colour = "#969595",
                                linewidth = 0.5),
    axis.text.x = element_text(size = 10, 
                               angle = 75, 
                               hjust = 0, 
                               vjust = -0.2),
    axis.title.x = element_blank(),
    panel.border = element_blank(),
    legend.position = "none") +
  scale_x_date(expand = c(0,0), 
               date_breaks = "1 month", 
               date_labels = "%b '%y",
               limit = c(as.Date("2020-01-01"),
                         as.Date("2022-12-31"))) +
  geom_vline(xintercept = as.Date("2022-11-16"), color = "limegreen", size = 1) + 
  geom_vline(xintercept = as.Date("2022-09-05"), color = "limegreen", size = 1) +
  geom_vline(xintercept = as.Date("2022-03-16"), color = "limegreen", size = 1) +
  geom_vline(xintercept = as.Date("2021-08-23"), color = "limegreen", size = 1) +
  geom_vline(xintercept = as.Date("2022-02-24"), color = "orange", size = 1) +
  geom_vline(xintercept = as.Date("2022-04-26"), color = "red", size = 1) +
  geom_vline(xintercept = as.Date("2022-03-24"), color = "red", size = 1) +
  geom_vline(xintercept = as.Date("2021-11-26"), color = "red", size = 1) +
  geom_vline(xintercept = as.Date("2021-10-09"), color = "red", size = 1) +
  geom_vline(xintercept = as.Date("2021-05-08"), color = "red", size = 1) + 
  geom_vline(xintercept = as.Date("2020-11-09"), color = "red", size = 1) +
  geom_vline(xintercept = as.Date("2020-06-02"), color = "red", size = 1) +
  geom_vline(xintercept = as.Date("2020-04-07"), color = "red", size = 1) +
  geom_vline(xintercept = as.Date("2020-02-07"), color = "red", size = 1)

asean_horPlot
```

Remarks :

Noticed after Russia invaded Ukraine, as indicated by the Orange line, both Laos and Thailand are prone to have negative rates month-over-month.

## 4.2 Visualise Import & Export 

### 4.2.1 Scatter Plot

#### 4.2.1.1 16 members of G20 countries

```{r}
#| fig-height: 14
#| fig-width: 14
g16YoY_plot <- ggplot(g16,
                        aes(x = export,
                            y = import,
                            text = paste("Country :", country,
                                         "\nYoY :", period))) +
  geom_point(aes(fill = country),
             alpha = 0.6,
             colour = "white",
             stroke = 0.2) +
  facet_grid(~year) +
  labs(x = "Export Volume (Thousands Dollars)",
       y = "Import Volume (Thousands Dollars)") +
  ggtitle ("Singapore YOY Trade Performance with G16 Countries") +
  theme(axis.text.x = element_text(size = 7, 
                                   angle = 45),
        axis.text.y = element_text(size = 7),
        axis.title.y = element_text(margin = margin(r = 10), 
                                    size = 8,
                                    face = "bold",
                                    colour = "#302f2f"),
        axis.title.x = element_text(size = 8,
                                    face = "bold",
                                    colour = "#302f2f",
                                    margin = margin(t = 15)),
        strip.text = element_text(size = 8,
                                  face = "bold",
                                  colour = "#424242"),
        strip.background = element_blank(),
        plot.margin = margin(0.8, 0.5, 0.5, 1.5, "cm"))

  
ggplotly(g16YoY_plot,
         tooltip = c("x", "y", "text")) %>%
  layout(legend = list(x = 0,
                       y = -0.4,
                       orientation = "h",
                       xanchor = "left", 
                       yanchor = "bottom"))
```

<br>

#### 4.2.1.2 ASEAN members

Visualise trading performances (import and export) with other ASEAN members.

```{r}
#| fig-height: 12
#| fig-width: 14
aseanYoY_plot <- ggplot(asean,
                        aes(x = export,
                            y = import,
                            text = paste("Country :", country,
                                         "\nYoY :", period))) +
  geom_point(aes(fill = country),
             alpha = 0.6,
             colour = "white",
             stroke = 0.2) +
  facet_grid(~year) +
  labs(x = "Export Volume (Thousands Dollars)",
       y = "Import Volume (Thousands Dollars)") +
  ggtitle ("Singapore YOY Trade Performance with ASEAN Countries") +
  theme(axis.text.x = element_text(size = 7, 
                                   angle = 45),
        axis.text.y = element_text(size = 7),
        axis.title.y = element_text(margin = margin(r = 10), 
                                    size = 8,
                                    face = "bold",
                                    colour = "#302f2f"),
        axis.title.x = element_text(size = 8,
                                    face = "bold",
                                    colour = "#302f2f",
                                    margin = margin(t = 15)),
        strip.text = element_text(size = 8,
                                  face = "bold",
                                  colour = "#424242"),
        strip.background = element_blank(),
        plot.margin = margin(0.8, 0.5, 0.5, 1.5, "cm"))

  
ggplotly(aseanYoY_plot,
         tooltip = c("x", "y", "text")) %>%
  layout(legend = list(x = 0,
                       y = -0.4,
                       orientation = "h",
                       xanchor = "left", 
                       yanchor = "bottom"))
```

<br>

#### 4.2.1.3 European Union members

```{r}
#| fig-height: 15
#| fig-width: 14
euYoY_plot <- ggplot(eUnion,
                        aes(x = export,
                            y = import,
                            text = paste("Country :", country,
                                         "\nYoY :", period))) +
  geom_point(aes(fill = country),
             alpha = 0.6,
             colour = "white",
             stroke = 0.2) +
  facet_grid(~year) +
  labs(x = "Export Volume (Thousands Dollars)",
       y = "Import Volume (Thousands Dollars)") +
  ggtitle ("Singapore YOY Trade Performance with EU Members") +
  theme(axis.text.x = element_text(size = 7, 
                                   angle = 45),
        axis.text.y = element_text(size = 7),
        axis.title.y = element_text(margin = margin(r = 10), 
                                    size = 8,
                                    face = "bold",
                                    colour = "#302f2f"),
        axis.title.x = element_text(size = 8,
                                    face = "bold",
                                    colour = "#302f2f",
                                    margin = margin(t = 15)),
        strip.text = element_text(size = 8,
                                  face = "bold",
                                  colour = "#424242"),
        strip.background = element_blank(),
        plot.margin = margin(0.8, 0.5, 0.5, 1.5, "cm"))

  
ggplotly(euYoY_plot,
         tooltip = c("x", "y", "text")) %>%
  layout(legend = list(x = 0,
                       y = -0.55,
                       orientation = "h",
                       xanchor = "left", 
                       yanchor = "bottom"))
```

<br>

### 4.2.2 Lines Plot

#### 4.2.2.1 Trade Performances with each ASEAN members

```{r}
#| fig-height: 12
#| fig-width: 14
ggplot(data = asean_pvW,
       aes (x = period,
            y = tradeVolume)) +
  geom_line(aes
            (color = tradeType, 
              linetype = tradeType)) +
  scale_color_manual(values = c("darkred", "steelblue")) +
  facet_wrap(~country) +
  labs(y = "Trade Volume\n(Thousand Dollars)",
       x = "Year",
       title = "Total trade volume with each ASEAN members",
       subtitle = "from January 2020 to December 2022",
       caption = "Data Source : Singstat.gov.sg, 2023") +
  theme(plot.title = element_text(size = 20,
                                  colour = "#302f2f",
                                  face = "bold"),
        plot.subtitle = element_text(size = 12,
                                  colour = "#424242",
                                  face = "italic"),
        axis.text.x = element_text(size = 7, 
                                   angle = 60, 
                                   hjust = 0, 
                                   vjust = -0.1),
        axis.text.y = element_text(size = 7),
        axis.title.y = element_text(angle = 0, 
                                    size = 8,
                                    face = "bold",
                                    colour = "#302f2f",
                                    vjust = 1.2,
                                    margin = margin(r = -30)),
        axis.title.x = element_text(size = 8,
                                    face = "bold",
                                    colour = "#302f2f",
                                    margin = margin(9,0,0,0)),
        strip.text = element_text(size = 10,
                                  face = "bold",
                                  colour = "#424242"),
        strip.background = element_blank(),
        plot.margin = margin(0.5,0.5,0.5,0.5,"cm"),
        legend.position = "bottom",
        legend.justification = "left")
```

#### 4.2.2.2 Trade Performances with each European Union members

```{r}
#| fig-height: 14
#| fig-width: 14
ggplot(data = eUnion_pvW,
       aes (x = period,
            y = tradeVolume)) +
  geom_line(aes
            (color = tradeType, 
              linetype = tradeType)) +
  scale_color_manual(values = c("darkred", "steelblue")) +
  facet_wrap(~country) +
  labs(y = "Trade Volume\n(Thousand Dollars)",
       x = "Year",
       title = "Total trade volume with each European Union members",
       subtitle = "from January 2020 to December 2022",
       caption = "Data Source : Singstat.gov.sg, 2023") +
  theme(plot.title = element_text(size = 20,
                                  colour = "#302f2f",
                                  face = "bold"),
        plot.subtitle = element_text(size = 12,
                                  colour = "#424242",
                                  face = "italic"),
        axis.text.x = element_text(size = 7, 
                                   angle = 60, 
                                   hjust = 0, 
                                   vjust = -0.1),
        axis.text.y = element_text(size = 7),
        axis.title.y = element_text(angle = 0, 
                                    size = 8,
                                    face = "bold",
                                    colour = "#302f2f",
                                    vjust = 1.2,
                                    margin = margin(r = -30)),
        axis.title.x = element_text(size = 8,
                                    face = "bold",
                                    colour = "#302f2f",
                                    margin = margin(9,0,0,0)),
        strip.text = element_text(size = 10,
                                  face = "bold",
                                  colour = "#424242"),
        strip.background = element_blank(),
        plot.margin = margin(0.5,0.5,0.5,0.5,"cm"),
        legend.position = "bottom",
        legend.justification = "left")
```

<br>

## 4.3 SlopeGraph

::: {.callout-tip collapse="true" appearance="simple" icon="false"}
## [**⇳ Usage of the code chunk below :**]{style="color:#3a9c88"}

[***newggslopegraph( )*** - CGPfunctions -]{style="color:#d46e15"} to plot a slopegraph a lot Tufte using dplyr and ggplot2.
:::

```{r}
#| fig-height: 10
#| fig-width: 14
asean_export %>%
  newggslopegraph(year, volume_export, country,
                  Title = "Singapore Export Performances with ASEAN Members",
                  SubTitle = "from January 2020 to December 2022",
                  XTextSize = 10,
                  YTextSize = 2.5,
                  Caption = "Source from : Singstat.gov.sg 2023",
                  CaptionJustify = "left",
                  LineThickness = .5,
                  WiderLabels = TRUE,
                  DataTextSize = 3,
                  DataLabelFillColor = "#b3c8fc",
                  DataLabelPadding = 0.1)
```

Remarks :

The slopegraph above indicates Malaysia has the highest demand for Singapore merchandise, and the subsequent strongest growth demand is Indonesia, with a noticeable line gradient.

Regarding trade balance, among all ASEAN members, Singapore has a trade surplus with Indonesia, with noticeable line gradient that reflects healthy export growth.

Malaysia, on the contrary, shows the highest trade deficit despite growing demand for Singapore merchandise.

```{r}
#| fig-height: 10
#| fig-width: 14
asean_bot %>%
  newggslopegraph(year, bot, country,
                  Title = "Singapore Trade Balance with ASEAN Members",
                  SubTitle = "from January 2020 to December 2022",
                  XTextSize = 10,
                  YTextSize = 2.5,
                  Caption = "Source from : Singstat.gov.sg 2023",
                  CaptionJustify = "left",
                  LineThickness = .5,
                  WiderLabels = TRUE,
                  DataTextSize = 3,
                  DataLabelFillColor = "#b3c8fc",
                  DataLabelPadding = 0.1)
```

Remarks :

Due to larger data points for G16 and European Countries, faced heavily overlapping issues when attempt to plot slopegraph for them. Encountered various errors when attempting to combine ggrepel.

Due to the limited of time to explore solutions dealing with overlapping issue, there is no slopegraph for G16 and European Countries.

## 4.4 Stream Graph

Stream graph is used to reveal trends or periodic trading patterns from the beginning of year 2020 to the end of 2022.

### 4.4.1 Year-over-year(YoY) flow of trade balance regionally

```{r}
#| fig-height: 10
#| fig-width: 14
region_areaPlot <- ggplot(tradesM_bot,
                       aes(x = period, 
                           y = bot,
                           text = paste("Region : ", region),
                           fill = fct_reorder(region,
                                              bot,
                                              .desc = TRUE)),
                       position = "identity") +
  geom_area(alpha = 0.6,
            linewidth = .2,
            colour = "white") +
  scale_fill_viridis(discrete = TRUE) +
  theme_ipsum() +
  labs(x = "Period",
       y = "Balance of Trade (Million Dollars)",
       fill = "Regions") +
  ggtitle("Singapore Trade Balance (BOT) by Regions from Jan 2020 to Dec 2022") +
  theme(axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size = 8),
        axis.title.x = element_text(size = 8,
                                    margin = margin(t = 2)),
        panel.grid.major = element_line(linewidth = rel(0.1)))


region_areaPlot <- ggplotly(region_areaPlot,
                         tooltip = c("text", "bot", "period")) %>%
  layout(legend = list(y = -0.3,
                       orientation = "h",
                       xanchor = "left", 
                       yanchor = "bottom"))

region_areaPlot
```

Remarks :

The trade balance for Africa and Oceania regions show noticeable growth compare to

### 4.4.2 Year-over-year(YoY) BOT with ASEAN members

```{r}
#| fig-height: 12
#| fig-width: 14
asean_areaPlot <- ggplot(asean,
                       aes(x = period, 
                           y = bot,
                           text = paste("Country :", country),
                           fill = fct_reorder(country,
                                              bot,
                                              .desc = TRUE)),
                       position = "identity") +
  geom_area(alpha = 0.6,
            linewidth = .2,
            colour = "white") +
  scale_fill_viridis(discrete = TRUE) +
  theme_ipsum() +
  labs(x = "Period",
       y = "Balance of Trade (Thousand Dollars)",
       fill = "Country") +
  ggtitle("Singapore Trade Balance (BOT) with ASEAN from Jan 2020 to Dec 2022") +
  theme(axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size = 8,
                                    margin = margin(r = 10)),
        axis.title.x = element_text(size = 8,
                                    margin = margin(t = 2)),
        panel.grid.major = element_line(linewidth = rel(0.1)))


asean_areaPlot <- ggplotly(asean_areaPlot,
                         tooltip = c("text", "bot", "period")) %>%
  layout(legend = list(y = -0.35,
                       orientation = "h",
                       xanchor = "left", 
                       yanchor = "bottom"))

asean_areaPlot
```

<br>

### 4.4.3 Year-over-year(YoY) BOT with G16 members

```{r}
#| fig-height: 12
#| fig-width: 14
g16_areaPlot <- ggplot(g16,
                       aes(x = period, 
                           y = bot,
                           text = paste("Country :", country),
                           fill = fct_reorder(country,
                                              bot,
                                              .desc = TRUE)),
                       position = "identity") +
  geom_area(alpha = 0.6,
            linewidth = .2,
            colour = "white") +
  scale_fill_viridis(discrete = TRUE) +
  theme_ipsum() +
  labs(x = "Period",
       y = "Balance of Trade (Thousand Dollars)",
       fill = "Country") +
  ggtitle("Singapore Trade Balance (BOT) with G16  from Jan 2020 to Dec 2022") +
  theme(axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size = 8,
                                    margin = margin(r = 10)),
        axis.title.x = element_text(size = 8,
                                    margin = margin(t = 2)),
        panel.grid.major = element_line(linewidth = rel(0.1)))


g16_areaPlot <- ggplotly(g16_areaPlot,
                         tooltip = c("text", "bot", "period")) %>%
  layout(legend = list(y = -0.4,
                       orientation = "h",
                       xanchor = "left", 
                       yanchor = "bottom"))

g16_areaPlot
```

<br>

### 4.4.4 Year-over-year(YoY) BOT with European Union members

```{r}
#| fig-height: 12
#| fig-width: 14
eu_areaPlot <- ggplot(eUnion,
                       aes(x = period, 
                           y = bot,
                           text = paste("Country :", country),
                           fill = fct_reorder(country,
                                              bot,
                                              .desc = TRUE)),
                       position = "identity") +
  geom_area(alpha = 0.6,
            linewidth = .2,
            colour = "white") +
  scale_fill_viridis(discrete = TRUE) +
  theme_ipsum() +
  labs(x = "Period",
       y = "Balance of Trade (Thousand Dollars)",
       fill = "Country") +
  ggtitle("Singapore Trade Balance (BOT) with EU Members from Jan 2020 to Dec 2022") +
  theme(axis.text.x = element_text(size = 8),
        axis.text.y = element_text(size = 8),
        axis.title.y = element_text(size = 8,
                                    margin = margin(r = 10)),
        axis.title.x = element_text(size = 8,
                                    margin = margin(t = 2)),
        panel.grid.major = element_line(linewidth = rel(0.1)))


eu_areaPlot <- ggplotly(eu_areaPlot,
                         tooltip = c("text", "bot", "period")) %>%
  layout(legend = list(y = -0.6,
                       orientation = "h",
                       xanchor = "left", 
                       yanchor = "bottom"))

eu_areaPlot
```

<br>

## 4.5 Cycle Plots

Cycle plot allows viewer to compare the changes of lines' trend that reflects Singapore's monthly trading performances over different years.

### 4.5.1 Trading Performances by Regions

#### 4.5.1.1 Africa region

```{r}
#| fig-height: 6
#| fig-width: 14
africaRegion_cycPlot <- ggplot() +
  geom_line(data = africa,
            aes(x = year, 
                y = tradeTotal, 
                group = month), 
            colour = "black") +
  geom_line(data = africa,
            aes(x = year, 
                y = bot, 
                group = month), 
            colour = "red") +
  geom_line(data = africa,
            aes(x = year, 
                y = export, 
                group = month), 
            colour = "orange") +
  geom_hline(aes
             (yintercept = avg), 
             data = hl_africa, 
             linetype = 6, 
             colour = "blue", 
             linewidth = 0.5) + 
  facet_grid(~month) +
  labs(x = "Year-over-year Performance",
       y = "BOT\n(Million\nDollars)",
       title = "Singapore YOY Trade Performance (BOT) with Africa Region",
       subtitle = "from January 2020 to December 2022. Blue lines as a reference for the average of total trade volume,\norange lines for export volume & red lines for the BOT.") +
  theme(plot.title = element_text(size = 24,
                                  colour = "#302f2f",
                                  face = "bold"),
        plot.subtitle = element_text(size = 12,
                                  colour = "#424242",
                                  face = "italic"),
        axis.text.x = element_text(size = 9, 
                                   angle = 60, 
                                   hjust = 0, 
                                   vjust = -0.1),
        axis.text.y = element_text(size = 9),
        axis.title.y = element_text(angle = 0, 
                                    size = 9,
                                    face = "bold",
                                    colour = "#302f2f",
                                    vjust = 1.1,
                                    margin = margin(r = -20)),
        axis.title.x = element_text(size = 9,
                                    face = "bold",
                                    colour = "#302f2f",
                                    margin = margin(9,0,0,0)),
        strip.text = element_text(size = 12,
                                  face = "bold",
                                  colour = "#424242"),
        strip.background = element_blank(),
        plot.margin = margin(0.5,0.5,0.5,0.5,"cm"))

africaRegion_cycPlot
```

```{r}
#| output: false
#| fig-height: 12
#| fig-width: 14
africaRegion_cp <- ggplot() +
  geom_line(data = africa,
            aes(x = year, 
                y = tradeTotal, 
                group = month), 
            colour = "black") +
  geom_line(data = africa,
            aes(x = year, 
                y = bot, 
                group = month), 
            colour = "red") +
  geom_line(data = africa,
            aes(x = year, 
                y = export, 
                group = month), 
            colour = "orange") +
  geom_hline(aes
             (yintercept = avg), 
             data = hl_africa, 
             linetype = 6, 
             colour = "blue", 
             linewidth = 0.5) + 
  facet_grid(~month) +
  labs(x = "Year-over-year Performance",
       y = "BOT\n(Million\nDollars)",
       title = "Singapore YOY Trade Performance (BOT) with 5 Regions",
       subtitle = "from January 2020 to December 2022. Blue lines as a reference for the average of total trade volume,\norange lines for export volume & red lines for the BOT.\n\nAfrica Region") +
  theme(plot.title = element_text(size = 28,
                                  colour = "#302f2f",
                                  face = "bold"),
        plot.subtitle = element_text(size = 14,
                                  colour = "#424242",
                                  face = "italic",
                                  margin = margin(b = 2)),
        axis.text.x = element_blank(),
        axis.text.y = element_text(size = 9),
        axis.title.y = element_text(angle = 0, 
                                    size = 9,
                                    face = "bold",
                                    colour = "#302f2f",
                                    vjust = 1.1,
                                    margin = margin(r = -20)),
        axis.title.x = element_blank(),
        axis.ticks.x = element_blank(),
        strip.text = element_text(size = 12,
                                  face = "bold",
                                  colour = "#424242"),
        strip.background = element_blank(),
        plot.margin = margin(1,0.5,0.15,0.5,"cm"))
```

Remarks :

The code chunk above is the simplified version to be used for ggarrange overview plot.

#### 4.5.1.2 America region

```{r}
#| fig-height: 6
#| fig-width: 14
americaRegion_cycPlot <- ggplot() +
  geom_line(data = america,
            aes(x = year, 
                y = tradeTotal, 
                group = month), 
            colour = "black") +
  geom_line(data = america,
            aes(x = year, 
                y = bot, 
                group = month), 
            colour = "red") +
  geom_line(data = america,
            aes(x = year, 
                y = export, 
                group = month), 
            colour = "orange") +
  geom_hline(aes
             (yintercept = avg), 
             data = hl_america, 
             linetype = 6, 
             colour = "blue", 
             linewidth = 0.5) + 
  facet_grid(~month) +
  labs(x = "Year-over-year Performance",
       y = "BOT\n(Million\nDollars)",
       title = "Singapore YOY Trade Performance (BOT) with America Region",
       subtitle = "from January 2020 to December 2022. Blue lines as a reference for the average of total trade volume, orange lines for export volume & red lines for the BOT.") +
  theme(plot.title = element_text(size = 24,
                                  colour = "#302f2f",
                                  face = "bold"),
        plot.subtitle = element_text(size = 12,
                                  colour = "#424242",
                                  face = "italic"),
        axis.text.x = element_text(size = 9, 
                                   angle = 60, 
                                   hjust = 0, 
                                   vjust = -0.1),
        axis.text.y = element_text(size = 9),
        axis.title.y = element_text(angle = 0, 
                                    size = 9,
                                    face = "bold",
                                    colour = "#302f2f",
                                    vjust = 1.1,
                                    margin = margin(r = -20)),
        axis.title.x = element_text(size = 9,
                                    face = "bold",
                                    colour = "#302f2f",
                                    margin = margin(9,0,0,0)),
        strip.text = element_text(size = 12,
                                  face = "bold",
                                  colour = "#424242"),
        strip.background = element_blank(),
        plot.margin = margin(0.5,0.5,0.5,0.5,"cm"))

americaRegion_cycPlot
```

```{r}
#| output: false
#| fig-height: 6
#| fig-width: 14
americaRegion_cp <- ggplot() +
  geom_line(data = america,
            aes(x = year, 
                y = tradeTotal, 
                group = month), 
            colour = "black") +
  geom_line(data = america,
            aes(x = year, 
                y = bot, 
                group = month), 
            colour = "red") +
  geom_line(data = america,
            aes(x = year, 
                y = export, 
                group = month), 
            colour = "orange") +
  geom_hline(aes
             (yintercept = avg), 
             data = hl_america, 
             linetype = 6, 
             colour = "blue", 
             linewidth = 0.5) + 
  facet_grid(~month) +
  labs(x = "Year-over-year Performance",
       y = "BOT\n(Million\nDollars)",
       subtitle = "America Region") +
  theme(plot.subtitle = element_text(size = 14,
                                  colour = "#424242",
                                  face = "italic"),
        axis.text.x = element_blank(),
        axis.text.y = element_text(size = 9),
        axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        axis.ticks.x = element_blank(),
        strip.text = element_blank(),
        strip.background = element_blank(),        
        plot.margin = margin(0.2,0.5,0.2,0.5,"cm"))
```

#### 4.5.1.3 Asia Region

```{r}
#| fig-height: 6
#| fig-width: 14
asiaRegion_cycPlot <- ggplot() +
  geom_line(data = asia,
            aes(x = year, 
                y = tradeTotal, 
                group = month), 
            colour = "black") +
  geom_line(data = asia,
            aes(x = year, 
                y = bot, 
                group = month), 
            colour = "red") +
  geom_line(data = asia,
            aes(x = year, 
                y = export, 
                group = month), 
            colour = "orange") +
  geom_hline(aes
             (yintercept = avg), 
             data = hl_asia, 
             linetype = 6, 
             colour = "blue", 
             linewidth = 0.5) + 
  facet_grid(~month) +
  labs(x = "Year-over-year Performance",
       y = "BOT\n(Million\nDollars)",
       title = "Singapore YOY Trade Performance (BOT) with Asia Region",
       subtitle = "from January 2020 to December 2022. Blue lines as a reference for the average of total trade volume,\norange lines for export volume & red lines for the BOT.") +
  theme(plot.title = element_text(size = 24,
                                  colour = "#302f2f",
                                  face = "bold"),
        plot.subtitle = element_text(size = 12,
                                  colour = "#424242",
                                  face = "italic"),
        axis.text.x = element_text(size = 9, 
                                   angle = 60, 
                                   hjust = 0, 
                                   vjust = -0.1),
        axis.text.y = element_text(size = 9),
        axis.title.y = element_text(angle = 0, 
                                    size = 9,
                                    face = "bold",
                                    colour = "#302f2f",
                                    vjust = 1.1,
                                    margin = margin(r = -20)),
        axis.title.x = element_text(size = 9,
                                    face = "bold",
                                    colour = "#302f2f",
                                    margin = margin(9,0,0,0)),
        strip.text = element_text(size = 12,
                                  face = "bold",
                                  colour = "#424242"),
        strip.background = element_blank(),
        plot.margin = margin(0.5,0.5,0.5,0.5,"cm"))

asiaRegion_cycPlot
```

```{r}
#| output: false
#| fig-height: 6
#| fig-width: 14
asiaRegion_cp <- ggplot() +
  geom_line(data = asia,
            aes(x = year, 
                y = tradeTotal, 
                group = month), 
            colour = "black") +
  geom_line(data = asia,
            aes(x = year, 
                y = bot, 
                group = month), 
            colour = "red") +
  geom_line(data = asia,
            aes(x = year, 
                y = export, 
                group = month), 
            colour = "orange") +
  geom_hline(aes
             (yintercept = avg), 
             data = hl_asia, 
             linetype = 6, 
             colour = "blue", 
             linewidth = 0.5) + 
  facet_grid(~month) +
  labs(x = "Year-over-year Performance",
       y = "BOT\n(Million\nDollars)",
       subtitle = "Asia Region") +
  theme(plot.subtitle = element_text(size = 14,
                                  colour = "#424242",
                                  face = "italic"),
        axis.text.x = element_blank(),
        axis.text.y = element_text(size = 9),
        axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        axis.ticks.x = element_blank(),
        strip.text = element_blank(),
        strip.background = element_blank(),        
        plot.margin = margin(0.2,0.5,0.2,0.5,"cm"))
```

#### 4.5.1.4 Europe Region

```{r}
#| fig-height: 6
#| fig-width: 14
europeRegion_cycPlot <- ggplot() +
  geom_line(data = europe,
            aes(x = year, 
                y = tradeTotal, 
                group = month), 
            colour = "black") +
  geom_line(data = europe,
            aes(x = year, 
                y = bot, 
                group = month), 
            colour = "red") +
  geom_line(data = europe,
            aes(x = year, 
                y = export, 
                group = month), 
            colour = "orange") +
  geom_hline(aes
             (yintercept = avg), 
             data = hl_europe, 
             linetype = 6, 
             colour = "blue", 
             linewidth = 0.5) + 
  facet_grid(~month) +
  labs(x = "Year-over-year Performance",
       y = "BOT\n(Million\nDollars)",
       title = "Singapore YOY Trade Performance (BOT) with Europe Region",
       subtitle = "from January 2020 to December 2022. Blue lines as a reference for the average of total trade volume,\norange lines for export volume & red lines for the BOT.") +
  theme(plot.title = element_text(size = 24,
                                  colour = "#302f2f",
                                  face = "bold"),
        plot.subtitle = element_text(size = 12,
                                  colour = "#424242",
                                  face = "italic"),
        axis.text.x = element_text(size = 9, 
                                   angle = 60, 
                                   hjust = 0, 
                                   vjust = -0.1),
        axis.text.y = element_text(size = 9),
        axis.title.y = element_text(angle = 0, 
                                    size = 9,
                                    face = "bold",
                                    colour = "#302f2f",
                                    vjust = 1.1,
                                    margin = margin(r = -20)),
        axis.title.x = element_text(size = 9,
                                    face = "bold",
                                    colour = "#302f2f",
                                    margin = margin(9,0,0,0)),
        strip.text = element_text(size = 12,
                                  face = "bold",
                                  colour = "#424242"),
        strip.background = element_blank(),
        plot.margin = margin(0.5,0.5,0.5,0.5,"cm"))

europeRegion_cycPlot
```

```{r}
#| output: false
#| fig-height: 6
#| fig-width: 14
europeRegion_cp <- ggplot() +
  geom_line(data = europe,
            aes(x = year, 
                y = tradeTotal, 
                group = month), 
            colour = "black") +
  geom_line(data = europe,
            aes(x = year, 
                y = bot, 
                group = month), 
            colour = "red") +
  geom_line(data = europe,
            aes(x = year, 
                y = export, 
                group = month), 
            colour = "orange") +
  geom_hline(aes
             (yintercept = avg), 
             data = hl_europe, 
             linetype = 6, 
             colour = "blue", 
             linewidth = 0.5) + 
  facet_grid(~month) +
  labs(x = "Year-over-year Performance",
       y = "BOT\n(Million\nDollars)",
       subtitle = "Europe Region") +
  theme(plot.subtitle = element_text(size = 14,
                                  colour = "#424242",
                                  face = "italic"),
        axis.text.x = element_blank(),
        axis.text.y = element_text(size = 9),
        axis.title.y = element_blank(),
        axis.title.x = element_blank(),
        axis.ticks.x = element_blank(),
        strip.text = element_blank(),
        strip.background = element_blank(),        
        plot.margin = margin(0.2,0.5,0.2,0.5,"cm"))
```

#### 4.5.1.5 Oceania Region

```{r}
#| fig-height: 6
#| fig-width: 14
oceaniaRegion_cycPlot <- ggplot() +
  geom_line(data = oceania,
            aes(x = year, 
                y = tradeTotal, 
                group = month), 
            colour = "black") +
  geom_line(data = oceania,
            aes(x = year, 
                y = bot, 
                group = month), 
            colour = "red") +
  geom_line(data = oceania,
            aes(x = year, 
                y = export, 
                group = month), 
            colour = "orange") +
  geom_hline(aes
             (yintercept = avg), 
             data = hl_oceania, 
             linetype = 6, 
             colour = "blue", 
             linewidth = 0.5) + 
  facet_grid(~month) +
  labs(x = "Year-over-year Performance",
       y = "BOT\n(Million\nDollars)",
       title = "Singapore YOY Trade Performance (BOT) with Oceania Region",
       subtitle = "from January 2020 to December 2022. Blue lines as a reference for the average of total trade volume,\norange lines for export volume & red lines for the BOT.") +
  theme(plot.title = element_text(size = 24,
                                  colour = "#302f2f",
                                  face = "bold"),
        plot.subtitle = element_text(size = 12,
                                  colour = "#424242",
                                  face = "italic"),
        axis.text.x = element_text(size = 9, 
                                   angle = 60, 
                                   hjust = 0, 
                                   vjust = -0.1),
        axis.text.y = element_text(size = 9),
        axis.title.y = element_text(angle = 0, 
                                    size = 9,
                                    face = "bold",
                                    colour = "#302f2f",
                                    vjust = 1.1,
                                    margin = margin(r = -20)),
        axis.title.x = element_text(size = 9,
                                    face = "bold",
                                    colour = "#302f2f",
                                    margin = margin(9,0,0,0)),
        strip.text = element_text(size = 12,
                                  face = "bold",
                                  colour = "#424242"),
        strip.background = element_blank(),
        plot.margin = margin(0.5,0.5,0.5,0.5,"cm"))

oceaniaRegion_cycPlot
```

```{r}
#| output: false
#| fig-height: 8
#| fig-width: 14
oceaniaRegion_cp <- ggplot() +
  geom_line(data = oceania,
            aes(x = year, 
                y = tradeTotal, 
                group = month), 
            colour = "black") +
  geom_line(data = oceania,
            aes(x = year, 
                y = bot, 
                group = month), 
            colour = "red") +
  geom_line(data = oceania,
            aes(x = year, 
                y = export, 
                group = month), 
            colour = "orange") +
  geom_hline(aes
             (yintercept = avg), 
             data = hl_oceania, 
             linetype = 6, 
             colour = "blue", 
             linewidth = 0.5) + 
  facet_grid(~month) +
  labs(x = "Year-over-year Performance",
       y = "BOT\n(Million\nDollars)",
       subtitle = "Oceania Region") +
  theme(plot.subtitle = element_text(size = 14,
                                  colour = "#424242",
                                  face = "italic"),
        axis.text.x = element_text(size = 9, 
                                   angle = 60, 
                                   hjust = 0, 
                                   vjust = -0.1),
        axis.text.y = element_text(size = 9),
        axis.title.y = element_blank(),
        axis.title.x = element_text(size = 9,
                                    face = "bold",
                                    colour = "#302f2f",
                                    margin = margin(9,0,0,0)),
        strip.text = element_blank(),
        strip.background = element_blank(),        
        plot.margin = margin(0.2,0.5,1,0.5,"cm"))
```

#### 4.5.1.6 Overview for All 5 Regions

```{r}
#| fig-height: 30
#| fig-width: 14
ggpubr::ggarrange(africaRegion_cp,
                  americaRegion_cp,
                  asiaRegion_cp,
                  europeRegion_cp,
                  oceaniaRegion_cp,
                  ncol = 1,
                  nrow = 5,
                  align = "v")
```
